"use strict";function getUrlVars(){for(var e,i=[],t=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),r=0;r<t.length;r++)e=t[r].split("="),i.push(e[0]),i[e[0]]=e[1];return i}function marquee(e,i,t,r){function s(){if(a>=r){n.css("top","0px"),a=0;var e=$(i).children()[0].innerHTML;n.children()[0].remove(),n.append("<li>"+e+"</li>")}else a+=1,n.css("top",-a+"px")}var n=(document.getElementById(e).offsetHeight,$(i)),a=0;return setInterval(s,t)}var debugWx=!1,hostname=window.location.hostname.split("."),token="",req=new XMLHttpRequest;req.open("GET","/config",!1),req.send(null);var response=JSON.parse(req.responseText);debugWx=!1;var code=getUrlVars().code;if(code){var apiUri=response.api+"/api";req.open("GET",apiUri+"/wechat/token?code="+code,!1),req.setRequestHeader("X-API-From",response.config.from),req.setRequestHeader("X-Component",response.config.component),req.send(null),token=JSON.parse(req.responseText).token}angular.module("clientApp",["clientApp.constants","ngCookies","ngResource","ngSanitize","ngAnimate","ngTouch","ui.router","ui.bootstrap","restangular","angularMoment","infinite-scroll","currencyFilter","ngTouch","angular-carousel","timer","monospaced.elastic","ngHolder","swipe","angularCSS","angular-md5"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","$logProvider","RestangularProvider","$cssProvider",function(e,i,t,r,s,n,a){angular.extend(a.defaults,{preload:!0}),i.otherwise("/"),t.html5Mode(!0),r.defaults.useXDomain=!0,delete r.defaults.headers.common["X-Requested-With"],s.debugEnabled("disable")}]).run(["appConfig","md5","$rootScope","$cookieStore","$state","$stateParams","$location","Restangular","RestWechat","Wechat","Alert",function(e,i,t,r,s,n,a,o,d,l,c){t.appConfig=window.SONGNI_CFG_API=e;var p=a.host().substring(19),g=e.apiUri[i.createHash(p)];!g&&(g=e.uri),o.setBaseUrl(g+"/api"),o.setErrorInterceptor(function(e,i,t){401===e.status&&(r.remove("token"),d.one("client").get().then(function(e){location.href=e.link}))}),o.addResponseInterceptor(function(e,i,t,s,n,a){return 205===n.status&&(r.remove("token"),c.add("warning","刷新重新加载本地内容！"),location.reload()),e});var u={"X-API-From":e.from,"X-Component":e.component};o.setDefaultHeaders(u),token&&r.put("token",token),r.get("token")&&(u.Authorization=r.get("token"),o.setDefaultHeaders(u),d.one("userinfo").get().then(function(e){t.user=e})),o.one("merchant").get().then(function(e){t.merchant=e}),t.$on("$stateChangeStart",function(e,i,n,a,o){t.referer=s.href(a.name,o),i.authenticate&&!r.get("token")&&(e.preventDefault(),d.one("client").get({referer:s.href(i.name,n)}).then(function(e){location.href=e.link}))}),t.$on("$stateChangeSuccess",function(e,i,r,n,a){var o=["gift.detail.share","order.detail.fillin","order.detail.fillin-one2many","order.detail.one2one-received","order.detail.one2one-address","order.detail.one2many-address","order.detail.fillin-one2one","order.detail.received-result","order.detail.subscribe","order.detail.received-guide"];t.referer=s.href(n.name,a),document.body.scrollTop=document.documentElement.scrollTop=0,o.indexOf(i.name)>=0?t.bodyStyle="bgGreen":t.bodyStyle="bgGrey"}),l.config(),wx.error(function(e){c.add("warning",e.errMsg),console.log(e.errMsg)}),t.isAndroid=navigator.userAgent.match(/Android/i),t.clientWidth=document.body.clientWidth}]),function(e,i){e.module("clientApp.constants",[]).constant("appConfig",{uri:"http://api.91songli.cc",imgUri:"img.91pintuan.com",phtUri:"photo.91pintuan.com",phtUriExotic:"http://photo.91pintuan.com",component:"5581117b5f225e4c401c9259",apiUri:{acd5e6e0ab2c366ea83d21c106c07912:"http://api.91songli.cc","4fbe2e7d1ce5245067a9a82ea8f04bb5":"http://api.91songli.com","45d904d7de17319d5c8148062b2ad308":"http://api.91songli.cc","6cc673aa5f23836bb0de7bf6f839d2fd":"http://api.dalibao.com","4f3aee5014f4f60f0eb7bbf10e621646":"http://apidev.91songli.cc","887e3c18637d78c3a747e37f77f7c8a9":"http://apidev.91songli.cc"},debug:!1,from:"client"})}(angular),angular.module("clientApp").service("Alert",["$rootScope","$timeout",function(e,i){var t={};return e.alerts=[],t.add=function(r,s,n){e.alerts.push({type:r,msg:s,close:function(){t.closeAlert(this)}}),i(function(){t.closeAlert(this)},n||3e3)},t.closeAlert=function(i){t.closeAlertIdx(e.alerts.indexOf(i))},t.closeAlertIdx=function(i){e.alerts.splice(i,1)},t}]),angular.module("clientApp").directive("targetForAndroid",function(){return{restrict:"A",link:function(e,i,t){i.href;navigator.userAgent.match(/Android/i)&&i.attr("target","_self")}}}),angular.module("clientApp").filter("nl2br",["$sce",function(e){return function(i,t){var t=t||!0,r=t?"<br />":"<br>",i=(i+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+r+"$2");return e.trustAsHtml(i)}}]),angular.module("clientApp").directive("onLongPress",["$timeout","$parse",function(e,i){return{restrict:"A",link:function(t,r,s){r.bind("touchstart",function(r){t.longPress=!0;var n=i(s.onLongPress);e(function(){t.longPress&&t.$apply(function(){n(t,{$event:r})})},600)}),r.bind("touchend",function(e){t.longPress=!1;var r=i(s.onLongPress);s.onTouchEnd&&t.$apply(function(){r(t,{$event:e})})})}}}]),angular.module("clientApp").directive("phone",function(){return{require:"ngModel",link:function(e,i,t,r){r.$parsers.unshift(function(e){var i=/^(13[0-9]|14[0-9]|15[0-9]|17[0-9]|18[0-9])[0-9]{8}$/;return i.test(e)?(r.$setValidity("phone",!0),e):void r.$setValidity("phone",!1)})}}}),angular.module("clientApp").controller("GiftCtrl",["$scope","$rootScope",function(e,i){e.title="大礼包",i.bg2=!1,i.hideBar=!0}]).controller("GiftListCtrl",["$scope","$rootScope","$state","Gift",function(e,i,t,r){i.bg2=!1,e.apiCfg=window.SONGNI_CFG_API,e.gifts=new r,e.link=function(){var e=this.gift.id;t.go("gift.detail",{id:e})},wx.ready(function(){var e="http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png",t={title:i.merchant.info.name+"的礼物货架",link:window.location.href,imgUrl:e},r={title:"会说话的礼物",desc:i.merchant.info.name+"的礼物货架",link:window.location.href,imgUrl:e};wx.onMenuShareTimeline(t),wx.onMenuShareAppMessage(r),wx.onMenuShareQQ(r),wx.onMenuShareWeibo(r)})}]).controller("GiftDetailCtrl",["$scope","$rootScope","$state","$sce","gift","Alert",function(e,i,t,r,s,n){e.appid=hostname[0],e.apiCfg=window.SONGNI_CFG_API,s.info.name&&(i.title=s.info.name),i.bg2=!1,e.gift=s,e.tab="gift-card",e.tabTap=function(i){e.tab=i},e.iWS=function(){t.go("gift.detail.record",{id:e.gift.id})},e.trustAsHtml=function(e){return r.trustAsHtml(e)},wx.ready(function(){var e=s.info.cover?"http://"+SONGNI_CFG_API.phtUri+s.info.cover:"http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png",i={title:s.info.name,imgUrl:e},t={title:"会说话的礼物",desc:s.info.name,imgUrl:e};wx.onMenuShareTimeline(i),wx.onMenuShareAppMessage(t),wx.onMenuShareQQ(t),wx.onMenuShareWeibo(t)})}]).controller("ShareModalCtrl",["$scope","$uibModalInstance",function(e,i){e.shareSrc="https://img.91pintuan.com/songli/gift_share.png",e.isCloseModal=!1,e.$watch("isCloseModal",function(e){e&&i.close()})}]).controller("GiftShareCtrl",["$state","$scope","$rootScope","$stateParams","$uibModal","$window","RestGiftOrder","gift","$timeout",function(e,i,t,r,s,n,a,o,d){t.bg2=!1,i.gift=o,i.marqueeIntervalId=null;var l=20;a.one("list").one("s").getList("",{limit:l,gift:r.id}).then(function(e){if(e[1].length){i.suborders=[];for(var t=0,r=e[1].length;t<r;t++)for(var s=e[1][t],n=0,a=s.receivers.length;n<a;n++){var o=s.receivers[n];if(i.suborders.length>=l)break;i.suborders.push(o)}i.marqueeIntervalId=marquee("marquee_content","#marquee_content",40,40)}}),i.shareSrc="https://img.91pintuan.com/songli/gift_share.png",i.shareStyle={width:"50%"},i.share=function(){t.modalInstance=s.open({templateUrl:"app/gift/gift.share.modal.html",scope:i})},i.screen={height:n.innerHeight,width:n.innerWidth},i.$on("$destroy",function(){i.marqueeIntervalId&&clearInterval(i.marqueeIntervalId)})}]).controller("GiftOrdersCtrl",["$scope","$rootScope","$stateParams","RestGiftOrder",function(e,i,t,r){i.bg2=!0,r.one("list").one("s").getList("",{limit:10,gift:t.id}).then(function(i){e.orders=i[1];var t=(e.orders.length,0);e.empty_line=[];for(var t=0;t<3-e.orders.length;t++)e.empty_line.push(t)})}]).controller("GiftListenCtrl",["$scope","$rootScope","$state","$stateParams","$timeout","$window","RestGiftOrder","order","Alert",function(e,i,t,r,s,n,a,o,d){e.innerHeight=n.innerHeight,e.innerWidth=n.innerWidth,t.is("order.detail.info"),i.bg2=!0,e.order=o,e.status={downloading:!1,downloaded:!1,play:!1,pause:!1,stop:!1},a.one(r.id).one("media").get({from:r.from}).then(function(i){e.media=i})["catch"](function(e){console.error(e)}),e.play=function(){wx.downloadVoice({serverId:e.media.media_id,isShowProgressTips:1,success:function(i){e.localId=i.localId,e.status.play=!0,e.status.pause=!1,wx.playVoice({localId:i.localId,success:function(i){e.$broadcast("timer-start")}}),e.pause=function(){wx.pauseVoice({localId:i.localId,success:function(i){e.$broadcast("timer-stop"),e.status.play=!1,e.status.pause=!0,e.$apply()}})},e.resume=function(){wx.playVoice({localId:i.localId,success:function(i){e.$broadcast("timer-start"),e.status.play=!0,e.status.pause=!1,e.$apply()}})},e.stop=function(){wx.stopVoice({localId:i.localId}),e.$broadcast("timer-stop"),e.$broadcast("timer-set-countdown",60)},e.$apply()}}),wx.ready(function(){wx.onVoicePlayEnd({success:function(i){e.$broadcast("timer-set-countdown",60),e.$broadcast("timer-stop"),e.status.play=!1,e.status.pause=!0,e.status.stop=!0,e.$apply()}})})},e.link=function(){t.go("gift.detail.share",{id:o.gift.id})}}]).controller("GiftQrcodeCtrl",["$scope","$rootScope",function(e,i){}]).controller("GiftAudioCtrl",["$scope","ngAudio",function(e,i){e.audio=i.load("http://media.songni.cc/2015-7/JBDl12DpTjFIZFg3OCl7-529Aaqj7UHsXVBsfEAW9Cxtgo8UekdyrVxT9FizKcW2.amr")}]).controller("GiftGuideCtrl",["$scope","$rootScope","$stateParams","$window",function(e,i,t,r){i.bg2=!0,e.selection=0,e.innerHeight=r.innerHeight,e.innerWidth=r.innerWidth,e.swipe=function(i){"up"===i&&e.selection<2&&e.selection++,"down"===i&&e.selection>0&&e.selection--},e.items=[0,1,2],e.selection=e.items[0]}]).controller("GiftPoiModalCtrl",["$scope","$uibModalInstance","$window","pois","address",function(e,i,t,r,s){e.pois=r,e.address=s,e.selPoi=function(){var e=this.poi;i.close(e)},e.screen={height:t.innerHeight,width:t.innerWidth}}]),angular.module("clientApp").config(["$stateProvider",function(e){e.state("gift",{"abstract":!0,url:"/gift",template:"<ui-view/>"}).state("gift.list",{url:"/list",templateUrl:"app/gift/gift.lists.html",controller:"GiftListCtrl"}).state("gift.my",{url:"/my",templateUrl:"app/gift/orderlist/order.list.html",controller:"GiftMyCtrl"}).state("gift.listen",{url:"/listen/:id?from",templateUrl:"app/gift/gift.listen.html",controller:"GiftListenCtrl",resolve:{order:["$stateParams","RestGiftOrder",function(e,i){return i.one(e.id).one("detail").get({from:e.from})}]}}).state("gift.audio",{url:"/audio",templateUrl:"app/gift/gift.audio.html",controller:"GiftAudioCtrl"}).state("gift.detail",{url:"/:id",templateUrl:"app/gift/gift.detail.html",controller:"GiftDetailCtrl",resolve:{gift:["$state","$stateParams","$location","RestGift","Wechat","Alert",function i(e,t,r,s,n,a){var i=s.one(t.id).get(),o=window.SONGNI_CFG_API;return i.then(function(e){var i="http://"+r.host()+"/gift/"+e.id,t=e.info.name,s=e.info.lead,a=t,d="http://"+o.phtUri+e.info.cover;n.ready({url:i,title:t,desc:s,timeline:a,img:d}),e.status.online===!1}),i}]}}).state("gift.detail.one2one-record",{url:"/one2one-record",templateUrl:"app/gift/order/one2one/record.html",controller:"GiftRecordSingleCtrl",authenticate:!0}).state("gift.detail.one2many-record",{url:"/one2many-record",templateUrl:"app/gift/order/one2many/record.html",controller:"GiftRecordMultiCtrl",authenticate:!0}).state("gift.detail.share",{url:"/share?from",templateUrl:"app/gift/gift.share.html",controller:"GiftShareCtrl"}).state("gift.detail.orders",{url:"/orders",templateUrl:"app/gift/gift.orders.html",controller:"GiftOrdersCtrl"}).state("gift.detail.qrcode",{url:"/qrcode",templateUrl:"app/gift/gift.qrcode.html",controller:"GiftShareCtrl",authenticate:!0}).state("order",{"abstract":!0,url:"/order",template:"<ui-view/>"}).state("order.list",{url:"/list",templateUrl:"app/gift/orderlist/order.list.html",controller:"GiftMyCtrl"}).state("order.detail",{url:"/:id?from",template:"<ui-view/>","abstract":!0,resolve:{order:["$stateParams","RestGiftOrder",function(e,i){return i.one(e.id).one("detail").get({from:e.from})}]}}).state("order.detail.go",{url:"/go",controller:["$scope","$state","order",function(e,i,t){location.href=i.href("order.detail.info",{id:t.id})}]}).state("order.detail.one2one-address",{url:"/one2one-address",templateUrl:"app/gift/order/one2one/address.html",controller:"OrderAddressOne2OneCtrl",authenticate:!0}).state("order.detail.one2many-address",{url:"/one2many-address",templateUrl:"app/gift/order/one2many/address.html",controller:"OrderAddressOne2ManySendCtrl",authenticate:!0}).state("order.detail.guide",{url:"/guide",templateUrl:"app/gift/address.guide.html",controller:"OrderAddressCtrl",authenticate:!0}).state("order.detail.fillin",{url:"/fillin?from",templateUrl:"app/gift/order/gift.receive.status.html",controllerProvider:["order",function(e){return 1==e.capacity?"OrderAddressOne2OneCtrl":"OrderAddressOne2ManyRecevCtrl"}],authenticate:!0}).state("order.detail.subscribe",{url:"/subscribe",template:'<order-subscribe order="$ctrl.order"></order-subscribe>',controller:["order",function(e){this.order=e}],controllerAs:"$ctrl"}).state("order.detail.fillin-one2many",{url:"/fillin-one2many",templateUrl:"app/gift/order/one2many/address.fillin.html",controller:"OrderAddressOne2ManyRecevAddrCtrl",authenticate:!0}).state("order.detail.fillin-one2one",{url:"/fillin-one2one",templateUrl:"app/gift/order/one2one/address.fillin.html",controller:"OrderAddressOne2OneRecevAddrCtrl",authenticate:!0}).state("order.detail.received-result",{url:"/received-result",template:'<order-received order="$ctrl.order"></order-received>',controller:["order",function(e){this.order=e}],controllerAs:"$ctrl",authenticate:!0}).state("order.detail.received-guide",{url:"/received-guide",template:'<order-received-guide order="$ctrl.order"></order-received-guide>',controller:["order",function(e){this.order=e}],controllerAs:"$ctrl",authenticate:!0}).state("order.detail.info",{url:"/info",templateUrl:"app/gift/orderlist/order.info.html",controller:"GiftOrderDetailCtrl",authenticate:!0}).state("order.detail.received",{url:"/received",templateUrl:"app/gift/orderlist/order.received.html",controller:"GiftReceivedCtrl",authenticate:!0}).state("order.detail.shipped",{url:"/shipped",templateUrl:"app/gift/orderlist/order.shipped.html",controller:"GiftShippedCtrl",authenticate:!0}).state("order.detail.listened",{url:"/listened",templateUrl:"app/gift/orderlist/order.listened.html",controller:"GiftListenedCtrl",authenticate:!0}).state("order.detail.listen",{url:"/listen",templateUrl:"app/gift/gift.listen.html",controller:"GiftListenCtrl",authenticate:!0}).state("guide",{url:"/guide?id",templateUrl:"app/gift/gift.guide.html",controller:"GiftGuideCtrl"}).state("test",{url:"/test",templateUrl:"app/gift/test.html",controller:"TestCtrl"})}]),angular.module("clientApp").service("RestGift",["Restangular",function(e){return e.service("gift")}]).service("RestGiftOrder",["Restangular",function(e){return e.service("gift/order")}]).factory("Gift",["RestGift",function(e){var i=function(e){this.items=[],this.busy=!1,this.page=1,this.limit=10,this.params=e||{}};return i.prototype.nextPage=function(){if(!this.busy){this.busy=!0;var i={page:this.page,limit:this.limit};this.params.tips&&(i.tips=!0),e.getList(i).then(function(e){for(var e=e[1],i=0;i<e.length;i++)this.items.push(e[i]);return e.length<this.limit?void(this.busy=!0):(this.page++,void(this.busy=!1))}.bind(this))}},i}]).factory("GiftOrder",["RestGiftOrder",function(e){var i=function(e){this.items=[],this.busy=!1,this.page=1,this.limit=10,this.count=0,this.params=e||{}};return i.prototype.nextPage=function(){this.busy||(this.busy=!0,this.params.page=this.page,this.params.limit=this.limit,e.one("list").one("s").getList("",this.params).then(function(e){this.count=e[0];for(var i=e[1],t=0;t<i.length;t++)this.items.push(i[t]);return i.length<this.limit?void(this.busy=!0):(this.page++,void(this.busy=!1))}.bind(this)))},i}]),angular.module("clientApp").controller("GiftRecordMultiCtrl",["$scope","$rootScope","$state","$cookies","$timeout","$uibModal","$window","Alert",function(e,i,t,r,s,n,a,o){e.innerHeight=a.innerHeight,i.moreRecode={background:"#F2F2F2"},i.bg2=!0,e.giftOrderCapacity=null,e.address={name:""},e.status={start:!1,stop:!0,record:!1,playVoice:!1,stopVoice:!0,isAlert:!0},e.$on("timer-stopped",function(e,i){console.log("Timer Stopped - data = ",i)}),wx.ready(function(){e.reduCapacity=function(){e.giftOrderCapacity&&e.giftOrderCapacity>2?e.giftOrderCapacity-=1:2==e.giftOrderCapacity&&o.add("warning","礼物份数至少是2份",2e3)},e.incrCapacity=function(){null==e.giftOrderCapacity?e.giftOrderCapacity=3:e.giftOrderCapacity>0&&(e.giftOrderCapacity+=1)},e.record=function(){e.$broadcast("timer-set-countdown",60),wx.startRecord({success:function(i){e.status.start=!0,e.status.stop=!1,e.status.record=!1,e.$broadcast("timer-start"),e.$apply()}})},e.stop=function(){wx.stopRecord({success:function(i){e.localId=i.localId,e.status.start=!1,e.status.record=!0,e.$broadcast("timer-stop"),e.$apply()}})},e.playVoice=function(){return e.$broadcast("timer-set-countdown",60),i.isAndroid&&e.status.isAlert?(n.open({templateUrl:"app/gift/gift.headphones.modal.html",controller:["$scope","$uibModalInstance",function(e,i){e.close=function(){i.dismiss("cancel")}}],size:"sm"}),e.status.isAlert=!1,void e.$apply()):void wx.playVoice({localId:e.localId,success:function(){e.$broadcast("timer-start"),e.$apply()}})},e.rerecord=function(){e.$broadcast("timer-reset"),e.$broadcast("timer-set-countdown",60),e.status={start:!1,stop:!0,record:!1,playVoice:!1,stopVoice:!0}},e.save=function(){return e.giftOrderCapacity&&e.giftOrderCapacity<2?void o.add("warning","礼物份数至少是2份",2e3):void wx.uploadVoice({localId:e.localId,isShowProgressTips:1,success:function(i){e.serverId=i.serverId;var s=r.getObject("giftOrder")||{};s.serverId=i.serverId,s.name=e.address.name,s.capacity=e.giftOrderCapacity||2,s.type="one2many",r.putObject("giftOrder",s);var n=t.href("wepay",{module:"gift",type:s.type,action:"pay",block:"order",id:e.gift.id,showwxpaytitle:1});location.href=n}})},wx.onVoiceRecordEnd({complete:function(i){e.localId=i.localId,e.status.start=!1,e.status.record=!0,e.$apply()}}),wx.onVoicePlayEnd({success:function(i){e.$broadcast("timer-set-countdown",60),e.$broadcast("timer-stop"),e.$apply()}})})}]).controller("GiftPayOne2ManyCtrl",["$scope","$rootScope","$window","$state","$stateParams","$cookies","$timeout","RestGift","Alert","$css",function(e,i,t,r,s,n,a,o,d,l){var c=(s.module,s.action,s.id);s.block;e.gift=o.one(c).get().$object,e.capacity=n.getObject("giftOrder").capacity,e.submiting=!1,e.wxPay=function(){var i=n.getObject("giftOrder");e.submiting=!0,a(function(){e.submiting=!1},5e3),o.one(c).one("preorder").post("",i).then(function(i){wx.chooseWXPay({timestamp:i.timestamp,nonceStr:i.nonceStr,"package":i["package"],signType:i.signType,paySign:i.paySign,success:function(e){var t=r.href(i.state,{id:i.id});location.href=t},cancel:function(i){e.submiting=!1},fail:function(i){e.submiting=!1,d.add("warning",i.errMsg)}})},function(e){d.add("danger",e.data.errmsg)})}}]).controller("OrderAddressOne2ManySendCtrl",["$scope","$rootScope","$state","$cookies","Wechat","$location","order","$uibModal",function(e,i,t,r,s,n,a,o){i.bg2=!1,i.hideBar=!0,e.order=a,e.address={},e.user=i.user;var d="http://"+n.host()+t.href("order.detail.fillin",{id:a.id}),l=a.sender.name+"送给你一份礼物，快快收礼吧～",c=a.gift.info.name,p=a.gift.info.cover?"http://"+SONGNI_CFG_API.phtUri+a.gift.info.cover:"http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png",g=l+","+c;s.ready({url:d,title:l,desc:c,timeline:g,img:p}),e.share=function(){i.modalInstance=o.open({templateUrl:"app/gift/gift.share.modal.html",controller:"ShareModalCtrl"})}}]).controller("OrderAddressOne2ManyRecevCtrl",["$scope","$rootScope","$state","$stateParams","$cookies","Wechat","RestWechat","$location","order","$uibModal",function(e,i,t,r,s,n,a,o,d,l){function c(){var i=0,t=1,r=10,s=100;e.isAvailble&&(i=t),e.isReceived&&(i+=r),e.isSender&&(i+=s),e.orderStatus=i}if(e.order=d,e.user=i.user,i.bg2=!1,i.hideBar=!0,e.address={},e.isReceived=!1,e.isAvailble=!0,void 0===e.user&&a.one("client").get({referer:t.href("order.detail.fillin",r)}).then(function(e){window.location.href=e.link}),e.isSender=i.user.id===d.sender.id,e.isSender)return void(location.href=t.href("order.detail.one2many-address",{id:d.id}));e.orderStatus=0,_.some(d.receivers,function(e){return e.userOpenId==i.user.openid})&&(e.isReceived=!0),e.orderReserved=d.receivers.length,e.orderSurplus=d.capacity-d.receivers.length,0===e.orderSurplus&&(e.isAvailble=!1),e.fill=function(){if(e.isAndroid){var i=t.href("order.detail.fillin-one2many",{id:e.order.id});location.href=i}else t.go("order.detail.fillin-one2many",{id:e.order.id})},c();var p="http://"+o.host()+t.href("order.detail.fillin",{id:d.id}),g=d.sender.name+"送给你一份礼物，快快收礼吧～",u=d.gift.info.name,f=d.gift.info.cover?"http://"+SONGNI_CFG_API.phtUri+d.gift.info.cover:"http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png",m=g+","+u;n.ready({url:p,title:g,desc:u,timeline:m,img:f,state:"gift.detail.share",params:{id:e.order.gift.id}}),e.shareAsSender=function(){i.modalInstance=l.open({templateUrl:"app/gift/gift.share.modal.html",controller:"ShareModalCtrl"})}}]).controller("OrderAddressOne2ManyRecevAddrCtrl",["$scope","$rootScope","$state","$cookies","Wechat","$location","order","Alert","RestGiftOrder",function(e,i,t,r,s,n,a,o,d){i.bg2=!1,i.hideBar=!0,e.addressFriendForm={},e.address={consignee:"",telephone:"",address:""},e.order=a,e.saveAddr=function(r){var s=r&&r.giftAddrForm||e.addressFriendForm,n=r&&r.address||e.data,l=n.scene=n.poi?"poi":"logistics";return s.$invalid?(e.submitted=!0,r.submitted=!0,!1):void d.one(a.id).one("address").post("",n).then(function(e){switch(e.rc||console.error("saveAddr","没有response code !"),e.rc){case 1:o.add("success","你已经保存该礼物了",2e3);break;case 2:o.add("success","手慢了，没有礼物了",2e3);break;case 3:o.add("success","信息不全",2e3);break;case 4:if("poi"===l){var r=i.user;return r&&r.subscribe?void(location.href=t.href("order.detail.fillin",{id:a.id})):void(location.href=t.href("order.detail.subscribe",{id:a.id}))}location.href=t.href("gift.detail.share",{id:a.gift.id});break;default:o.add("warning","系统内部错误",2e3)}},function(e){alert("Get an err, "+JSON.stringify(e))})}}]),angular.module("clientApp").controller("GiftRecordSingleCtrl",["$scope","$rootScope","$state","$cookies","$timeout","$uibModal","$window","Alert",function(e,i,t,r,s,n,a,o){e.innerHeight=a.innerHeight,i.bg2=!0,e.status={start:!1,stop:!0,record:!1,playVoice:!1,stopVoice:!0,isAlert:!0},e.$on("timer-stopped",function(e,i){console.log("Timer Stopped - data = ",i)}),wx.ready(function(){e.record=function(){e.$broadcast("timer-set-countdown",60),wx.startRecord({success:function(i){e.status.start=!0,e.status.stop=!1,e.status.record=!1,e.$broadcast("timer-start"),e.$apply()}})},e.stop=function(){wx.stopRecord({success:function(i){e.localId=i.localId,e.status.start=!1,e.status.record=!0,e.$broadcast("timer-stop"),e.$apply()}})},e.playVoice=function(){return e.$broadcast("timer-set-countdown",60),i.isAndroid&&e.status.isAlert?(n.open({templateUrl:"app/gift/gift.headphones.modal.html",controller:["$scope","$uibModalInstance",function(e,i){e.close=function(){i.dismiss("cancel")}}],size:"sm"}),e.status.isAlert=!1,void e.$apply()):void wx.playVoice({localId:e.localId,success:function(){e.$broadcast("timer-start"),e.$apply()}})},e.rerecord=function(){e.$broadcast("timer-reset"),e.$broadcast("timer-set-countdown",60),e.status={start:!1,stop:!0,record:!1,playVoice:!1,stopVoice:!0}},e.save=function(){return e.giftAddrForm.$invalid?(e.submitted=!0,!1):void wx.uploadVoice({localId:e.localId,isShowProgressTips:1,success:function(i){e.serverId=i.serverId;var s=r.getObject("giftOrder")||{};s.serverId=i.serverId,s.name=e.address.name,s.capacity=1,s.type="one2one",r.putObject("giftOrder",s);var n=t.href("wepay",{module:"gift",type:"one2one",action:"pay",block:"order",id:e.gift.id,showwxpaytitle:1});location.href=n}})},wx.onVoiceRecordEnd({complete:function(i){e.localId=i.localId,e.status.start=!1,e.status.record=!0,e.$apply()}}),wx.onVoicePlayEnd({success:function(i){e.$broadcast("timer-set-countdown",60),e.$broadcast("timer-stop"),e.$apply()}})})}]).controller("GiftPayOne2OneCtrl",["$scope","$rootScope","$window","$state","$stateParams","$cookies","$timeout","RestGift","Alert","$css",function(e,i,t,r,s,n,a,o,d,l){var c=(s.module,s.action,s.id);e.gift=o.one(c).get().$object,e.capacity=n.getObject("giftOrder").capacity,e.submiting=!1,e.wxPay=function(){var i=n.getObject("giftOrder");e.submiting=!0,a(function(){e.submiting=!1},5e3),o.one(c).one("preorder").post("",i).then(function(i){wx.chooseWXPay({timestamp:i.timestamp,nonceStr:i.nonceStr,"package":i["package"],signType:i.signType,paySign:i.paySign,success:function(e){var t=r.href(i.state,{id:i.id});location.href=t},cancel:function(i){e.submiting=!1},fail:function(i){e.submiting=!1,d.add("warning",i.errMsg)}})},function(e){d.add("danger",e.data.errmsg)})}}]).controller("OrderReceivedOne2OneCtrl",["$timeout","$scope","$rootScope","$location","$state","$uibModal","$window","RestGiftOrder","Wechat","order","Alert",function(e,i,t,r,s,n,a,o,d,l,c){i.order=l,i.receiver=l.receivers[0]}]).controller("OrderAddressOne2OneCtrl",["$timeout","$scope","$rootScope","$location","$state","$uibModal","$window","RestGiftOrder","Wechat","order","Alert",function(e,i,t,r,s,n,a,o,d,l,c){if(1==l.capacity&&1==l.receivers.length){if(l.receivers[0].telephone)return void(i.order=l)}else c.add("warning","路径错误，此处为一送一！");i.innerHeight=a.innerHeight,t.bg2=!1,i.giftAddrForm={},i.order=l,i.address={consignee:l.receivers[0]?l.receivers[0].name:"",address:null,telephone:null},i.saveAddr=function(){if(i.giftAddrForm.$invalid)return i.submitted=!0,!1;address.scene=address.poi?"poi":"logistics";o.one(l.id).one("address").post("",i.address).then(function(e){switch(e.rc||console.error("saveAddr","没有response code !"),e.rc){case 1:c.add("success","你已经保存该礼物了",2e3);break;case 2:c.add("success","手慢了，没有礼物了",2e3);break;case 3:c.add("success","信息不全",2e3);break;case 4:location.href=s.href("gift.detail.share",{id:l.gift.id});break;default:c.add("warning","系统内部错误",2e3)}},function(e){console.log("Get an err, "+JSON.stringify(e))})};var p="http://"+r.host()+s.href("order.detail.fillin",{id:l.id}),g=l.sender.name+"送给你一份礼物，快快收礼吧～",u=l.gift.info.name,f=l.gift.info.cover?"http://"+SONGNI_CFG_API.phtUri+l.gift.info.cover:"http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png",m=g+","+u;d.ready({url:p,title:g,desc:u,timeline:m,img:f,state:"gift.detail.share",params:{id:i.order.gift.id}}),i.share=function(){t.modalInstance=n.open({templateUrl:"app/gift/gift.share.modal.html",controller:"ShareModalCtrl"})},i.fill=function(){location.href=s.href("order.detail.fillin-one2one",{id:l.id})}}]).controller("OrderAddressOne2OneRecevAddrCtrl",["$timeout","$scope","$rootScope","$location","$state","$uibModal","$window","RestGiftOrder","Wechat","order","Alert",function(e,i,t,r,s,n,a,o,d,l,c){i.order=l,i.address={consignee:l.receivers[0]?l.receivers[0].name:"",address:null,telephone:null}}]),angular.module("clientApp").component("orderInteract",{templateUrl:"app/gift/order/order.interact.html",bindings:{order:"<"},controller:function(){var e=this;this.$onInit=function(){e.scene=e.order.gift.scene||"logistics",e.remainCount=e.order.capacity-e.order.receivers.length}}}),angular.module("clientApp").component("orderPreReceive",{templateUrl:"app/gift/order/order.pre.receive.html",bindings:{order:"<",interact:"<",fill:"<",share:"<"},controller:["$rootScope","$state",function(e,i){var t=this;this.$onInit=function(){if(e.user)return t.isSender=t.order.sender.openid===e.user.openid,t.isReceiver=!t.isSender,t.type=t.order.capacity>1?"one2many":"one2one",t.isAvailable=function(){return"one2one"===t.type?!t.order.receivers[0].telephone:t.order.capacity-(t.order.receivers&&t.order.receivers.length||0)>0}(),t.isReceived=t.order.receivers.filter(function(i){return i.userOpenId===e.user.openid})[0],t.receivedCount="one2many"===t.type&&t.order.receivers&&t.order.receivers.length||0,t.availableCount="one2many"===t.type&&t.order.capacity-(t.order.receivers&&t.order.receivers.length||0)||0,t.isInteract=t.interact?!!t.interact:t.order.capacity>1&&t.receivedCount>1,t.scene=t.order.gift.scene,t.one2oneLogisticsSender=1===t.order.capacity&&"logistics"===t.scene&&t.isSender,t.one2oneLogisticsSender&&(t.address={logistics:!0,consignee:"",telephone:"",address:""}),1===t.order.capacity&&t.receivedCount>1&&(t.isSender||t.isReceiver)&&"poi"===t.scene?location.href=i.href("order.detail.received-guide",{id:t.order.id}):void 0}}]}),angular.module("clientApp").component("orderReceive",{templateUrl:"app/gift/order/order.receive.html",bindings:{order:"<",address:"=",isShare:"<",poiDisabled:"<",logisticsDisabled:"<",saveAddr:"<"},controller:["$rootScope","$state","$uibModal","Alert","RestWxPoi","RestGiftOrder",function(e,i,t,r,s,n){var a=this,o=this.order.id;this.$onInit=function(){a.scene=a.order.gift.scene||"logistics"},this.saveAddr||(this.saveAddr=function(t){return t.giftAddrForm.$invalid?(t.submitted=!0,!1):(a.address.poi?a.address.scene="poi":a.address.address&&(a.address.scene="logistics"),void n.one(a.order.id).one("address").post("",a.address).then(function(t){switch(t.rc||console.error("saveAddr","没有response code !"),t.rc){case 1:r.add("success","你已经保存该礼物了",2e3);break;case 2:r.add("success","手慢了，没有礼物了",2e3);break;case 3:r.add("success","信息不全",2e3);break;case 4:if("logistics"===a.scene&&(location.href=i.href("gift.detail.share",{id:a.order.gift.id})),"poi"===a.scene){var s=e.user;if(s.subscribe)return i.reload();location.href=i.href("order.detail.subscribe",{id:o})}break;default:r.add("warning","系统内部错误",2e3)}},function(e){console.log("Get an err, "+JSON.stringify(e))}))})}]}).component("orderReceivePoi",{templateUrl:"app/gift/order/order.receive.poi.html",bindings:{order:"<",address:"=",saveAddr:"<"},controller:["appConfig","$scope","$state","$uibModal","RestWxPoi","Alert","RestGiftOrder",function(e,i,t,r,s,n,a){var o=this;this.$onInit=function(){o.appConfig=e,o.poiLoaded=!1,o.errors=[];var i=o.order.gift;i.status.lbs?wx.ready(function(){wx.getLocation({success:function(e){s.get({tag:i.poitag,latitude:e.latitude,longitude:e.longitude}).then(function(e){o.pois=e,o.poiLoaded=!0})},cancel:function(){o.errors.push(new Error("您拒绝授权获取地理位置")),n.add("warning","您拒绝授权获取地理位置",2e3)},fail:function(e){alert(JSON.stringify(e)),o.errors.push(new Error("您拒绝授权获取地理位置")),n.add("warning","您拒绝授权获取地理位置",2e3)}})}):s.get({tag:i.poitag}).then(function(e){o.pois=e,o.poiLoaded=!0})},this.share=function(){$rootScope.modalInstance=r.open({templateUrl:"app/gift/gift.share.modal.html",controller:"ShareModalCtrl"})};var d=this.saveAddr;this.saveAddr=function(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];return o.errors.length?void o.errors.forEach(function(e){n.add("warning",e.message,2e3)}):void d.apply(null,i)},this.selPoi=function(){var e=o.pois,i=o.address,t=r.open({templateUrl:"app/gift/order/gift.poi.modal.html",controller:"GiftPoiModalCtrl",size:"lg",resolve:{pois:function(){return e},address:function(){return i}}});t.result.then(function(e){console.warn(o),o.address.poi=e})},i.document={width:document.getElementById("poi").offsetWidth}}]}).component("orderReceiveLogistics",{templateUrl:"app/gift/order/order.receive.logistics.html",
bindings:{order:"<",address:"=",isShare:"<",saveAddr:"<"},controller:["$rootScope","appConfig","$state","$uibModal","RestWxPoi","RestGiftOrder",function(e,i,t,r,s,n){var a=this;this.$onInit=function(){a.appConfig=i},this.share=function(){e.modalInstance=r.open({templateUrl:"app/gift/gift.share.modal.html",controller:"ShareModalCtrl"})}}]}),angular.module("clientApp").component("orderReceivedGuide",{templateUrl:"app/gift/order/order.received.guide.html",bindings:{order:"<",scene:"<"},controller:["$rootScope","$state","$uibModal","Alert","RestWxPoi","RestGiftOrder",function(e,i,t,r,s,n){var a=this;this.$onInit=function(){if(a.user=e.user,a.isSender=a.order.sender.openid===a.user.openid,a.receiver=a.order.receivers.filter(function(e){return e.userOpenId===a.user.openid})[0],a.isReceiver=!!a.receiver,a.scene=a.scene||a.isReceiver&&a.receiver.scene||null,a.receivedAll=function(){return 1===a.order.capacity?!!a.order.receivers[0].telephone:a.order.capacity===a.order.receivers.length}(),"logistics"===a.scene)return i.go("order.detail.received-result",{id:a.order.id},{location:"replace"})}}]}),angular.module("clientApp").component("orderReceived",{templateUrl:"app/gift/order/order.received.html",bindings:{order:"<"},controller:["$rootScope","$scope","$window","appConfig","$state","$uibModal","RestWxPoi","RestGiftOrder",function(e,i,t,r,s,n,a,o){var d=this;this.$onInit=function(){d.isSender=d.order.sender.openid===e.user.openid,d.scene=d.order.gift.scene||"logistics",d.appConfig=r,d.$rootScope=e,d.suborder=d.order.receivers.filter(function(i){return i.userOpenId===e.user.openid})[0]||null,d.isReceiver=!!d.suborder,d.isSender||d.isReceiver||(d.suborder=null)},this.openLocation=function(e){var i=e.base_info;wx.ready(function(){wx.openLocation({latitude:i.latitude,longitude:i.longitude,name:i.business_name+""+i.branch_name,address:i.province+i.city+i.district+i.address,scale:17,infoUrl:window.location.href,fail:function(e){location.reload()}})})},i.screen={height:t.innerHeight,width:t.innerWidth},i.document={width:document.getElementById("received").offsetWidth},i.openMerchant=function(){n.open({templateUrl:"app/gift/order/merchant.info.html",size:"lg"})}}]}),angular.module("clientApp").component("orderSubscribe",{templateUrl:"app/gift/order/order.subscribe.html",bindings:{order:"<"},controller:["$rootScope","RestGift","$window","appConfig",function(e,i,t,r){var s=this;this.$onInit=function(){s.user=e.user,i.one("wx_qrcode").get({scene:"giftSubToPushUnconsumedSuborder"}).then(function(e){s.qrcode=e.response.ticket}),s.appConfig=r,s.$window=t,s.$subscribeWidth=document.getElementById("subscribe").offsetWidth}}]}),angular.module("clientApp").controller("GiftMyCtrl",["$scope","$rootScope","$state","GiftOrder",function(e,i,t,r){i.isBody1=!0,i.isBody2=!1,e.apiCfg=window.SONGNI_CFG_API,i.bg2=!1,e.gifts=new r({my:!0}),e.link=function(e){t.go("order.detail.info",{id:e})}}]).controller("GiftOrderDetailCtrl",["$scope","$rootScope","$state","$stateParams","$timeout","$window","RestGiftOrder","order","Alert",function(e,i,t,r,s,n,a,o,d){i.isBody1=!0,i.isBody2=!1,e.innerHeight=n.innerHeight,e.innerWidth=n.innerWidth,e.apiCfg=window.SONGNI_CFG_API,i.bg2=!0,e.order=o,e.receiver=o.receivers[0],e.receive_num=o.receivers&&o.receivers.length||0,e.ship_num=o.receivers&&o.receivers.filter(function(e){return e.status.shipping}).length||0,e.listen_num=o.receivers&&o.receivers.filter(function(e){return e.status.read}).length||0;var l=o.receivers.reduce(function(e,i){return i.fillinDate?e&&e.fillinDate?moment(i.fillinDate).isAfter(e.fillinDate)?i:e:i:e},void 0);e.receivedTime=l&&l.fillinDate||"";var c=o.receivers.reduce(function(e,i){return i.status&&i.status.shipping_date?e&&e.status&&e.status.shipping_date?moment(i.status.shipping_date).isAfter(e.status.shipping_date)?i:e:i:e},void 0);e.shippedTime=c&&c.status.shipping_date||"";var p=o.receivers.reduce(function(e,i){return i.status&&i.status.read_date?e&&e.status&&e.status.read_date?moment(i.status.read_date).isAfter(e.status.read_date)?i:e:i:e},void 0);e.readTime=p&&p.status.read_date||"",e.link=function(){t.go("gift.detail.share",{id:o.gift.id})},e.received=function(){o.receivers.length&&t.go("order.detail.received",{id:o.id})},e.listened=function(){e.listen_num>0&&t.go("order.detail.listened",{id:o.id})},e.shipped=function(){e.ship_num>0&&t.go("order.detail.shipped",{id:o.id})},e.jumpToAddressCard=function(){t.go("order.detail.fillin",{id:o.id})}}]).controller("GiftShippedCtrl",["$scope","$rootScope","order",function(e,i,t){i.isBody1=!0,i.isBody2=!1;var r=[];angular.forEach(t.receivers,function(e){var i=e.status;i&&i.shipping&&r.push(e)}),alert(JSON.stringify(r[1])),e.receivers=r}]).controller("GiftListenedCtrl",["$scope","$rootScope","order",function(e,i,t){i.isBody1=!0,i.isBody2=!1;var r=[];angular.forEach(t.receivers,function(e){var i=e.status;i&&i.shipping&&i.read&&r.push(e)}),e.receivers=r}]).controller("GiftReceivedCtrl",["$scope","$rootScope","order",function(e,i,t){i.isBody1=!0,i.isBody2=!1;var r=[];angular.forEach(t.receivers,function(e){r.push(e)}),e.receivers=r}]),angular.module("clientApp").service("RestWxPoi",["RestWechat",function(e){return e.one("poi")}]),angular.module("clientApp").controller("LoginCtrl",["$scope","$rootScope","RestWechat",function(e,i,t){e.wechat=function(){t.one("client").get({referer:i.referer}).then(function(e){location.href=e.link})}}]).controller("ExpSetCtrl",["$cookieStore","$state","$stateParams","Alert",function(e,i,t,r){return t.token?(e.put("token",t.token),void(e.get("token")&&(location.href="/"))):void r.add("warning","请设置token")}]).controller("ExpCtrl",["$cookieStore","$stateParams","RestWechat",function(e,i,t){t.one("experience").get({uid:i.uid}).then(function(i){e.put("token",i.token),location.href="/"})}]),angular.module("clientApp").config(["$stateProvider",function(e){e.state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginCtrl"}).state("exp",{url:"/exp?uid",templateUrl:"app/login/login.html",controller:"ExpCtrl"})}]),angular.module("clientApp").controller("MainCtrl",["$scope","$rootScope","gifts",function(e,i,t){i.title="大礼包列表",i.hideBar=!0,e.gifts=t}]),angular.module("clientApp").config(["$stateProvider",function(e){e.state("main",{url:"/",templateUrl:"app/gift/gift.lists.html",controller:"GiftListCtrl",resolve:{gifts:["RestGift",function(e){return e.getList()}]}}).state("info",{url:"/info",templateUrl:"app/main/info.html"})}]),angular.module("clientApp").controller("WePayCtrl",["$scope","$rootScope","$window","$state","$stateParams","$timeout","$cookies","RestWechat","RestGift","Alert",function(e,i,t,r,s,n,a,o,d,l){i.title="微信支付";var c=s.module,p=s.action,g=s.id;switch(c){case"gift":switch(p){case"buy":e.gift=d.one(g).get().$object}}e.wxPay=function(){var e=function(e){wx.chooseWXPay({timestamp:e.timestamp,nonceStr:e.nonceStr,"package":e["package"],signType:e.signType,paySign:e.paySign,success:function(i){var t=r.href(e.state,{id:e.id});location.href=t},cancel:function(e){},fail:function(e){l.add("warning",e.errMsg)}})},i=function(e){l.add("danger",e.data.errmsg)};switch(c){case"gift":switch(p){case"buy":var t=a.getObject("giftOrder");d.one(g).post("",t).then(e,i)}}}}]).controller("WcAppCtrl",["$scope",function(e){var i;e.try_to_open_app=function(){i=setTimeout("open_appstore()",300)}}]),angular.module("clientApp").config(["$stateProvider",function(e){e.state("wepay",{url:"/wepay/?id&showwxpaytitle&module&block&type&action",templateUrl:function(e){var i="app/"+e.module+"/"+e.block+"/"+e.type+"/"+e.action+".html";return i},authenticate:!0}).state("weapp",{url:"/weapp",templateUrl:"app/wechat/app.html",controller:"WcAppCtrl"})}]),angular.module("clientApp").service("RestWechat",["Restangular",function(e){return e.service("wechat")}]).service("RestWxQrcode",["Restangular",function(e){return e.service("gift/wx_qrcode")}]).service("Wechat",["$rootScope","$location","$document","$state","RestWechat","Alert",function(e,i,t,r,s,n){return{params:{url:i.absUrl(),title:t[0].title,desc:this.url,img:"http://static.ifindu.cn/91pintuan/images/logo.png"},config:function(){this.params.url=this.params.url||i.absUrl(),s.one("sign").one("jssdk").get({type:"jsapi",url:this.params.url}).then(function(i){e.signature=i.signature;var t={debug:debugWx,appId:i.appId,timestamp:i.timestamp,nonceStr:i.nonceStr,signature:i.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo","chooseWXPay","editAddress","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","getLocation","onVoicePlayEnd","uploadVoice","downloadVoice","openLocation"]};wx.config(t)})},ready:function(i){try{i=i||{};var t=i.url?i.url:this.params.url,s=i.title?i.title:this.params.title,n=i.desc?i.desc:this.params.url,a=i.img?i.img:this.params.img,o={title:s,desc:n,link:t,imgUrl:a,success:function(t){e.modalInstance&&e.modalInstance.close(),i.state&&i.params&&r.go(i.state,i.params)},cancel:function(e){},fail:function(e){},complete:function(e){},trigger:function(e){}},d={title:i.timeline,link:t,imgUrl:a};wx.ready(function(){wx.onMenuShareTimeline(d),wx.onMenuShareAppMessage(o),wx.onMenuShareQQ(o),wx.onMenuShareWeibo(o)})}catch(l){alert(l.message)}}}}]),angular.module("clientApp").directive("iconHref",function(){function e(e,i,t){!t.theme&&(t.theme="grey"),e.theme=t.theme}return{restrict:"E",templateUrl:"components/icon-href/icon-href.html",link:e}}),angular.module("clientApp").component("marquee",{template:'\n\t\t\t<div>\n\t\t\t\t<ul>\n\t\t\t\t\t<li ng-repeat="item in items">\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t',bindings:{items:"<"},controller:["$rootScope","$scope","$window","appConfig","$state","$uibModal","RestWxPoi","RestGiftOrder",function(e,i,t,r,s,n,a,o){this.$onInit=function(){},this.$onChanges=function(){},this.onDestroy=function(){}}]}),angular.module("clientApp").factory("Modal",["$rootScope","$modal",function(e,i){function t(t,r){var s=e.$new();return t=t||{},r=r||"modal-default",angular.extend(s,t),i.open({templateUrl:"components/modal/modal.html",windowClass:r,scope:s})}return{confirm:{"delete":function(e){return e=e||angular.noop,function(){var i,r=Array.prototype.slice.call(arguments),s=r.shift();i=t({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+s+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(e){i.close(e)}},{classes:"btn-default",text:"Cancel",click:function(e){i.dismiss(e)}}]}},"modal-danger"),i.result.then(function(i){e.apply(i,r)})}}}}}]),angular.module("clientApp").controller("NavbarCtrl",["$scope","$location",function(e,i){e.menu=[{title:"Home",link:"/"}],e.isCollapsed=!0,e.isActive=function(e){return e===i.path()}}]),angular.module("clientApp").run(["$templateCache",function(e){e.put("app/directive/alert.html",'<uib-alert class="pt-alert alert-warning" ng-repeat="alert in alerts" type="{{alert.type}}" close="alert.close($index)">{{alert.msg}}</uib-alert>'),e.put("app/gift/address.guide.html",'<div>{{order.receiver.name}}:</div><p>我为你准备了一份惊喜,也有些话想对你说...</p><div class="pull-right">{{order.sender.name}}</div><div class="clearfix" style="clear:both"><a ui-sref="order.detail.fillin({id:order.id})" class="button button-action btn-green">填写地址</a></div>'),e.put("app/gift/gift.address.html",'<div class="gift-address"><table class="gift-top" width="100%"><tr><td align="center" width="34%"><img src="{{merchant.pubno.head_img}}" class="img-responsive img-circle"></td><td valign="middle" width="66%"><div class="title">{{gift.info.name}}</div></td></tr></table><form class="form-horizontal" name="giftAddrForm" novalidate ng-submit="saveAddr()"><div class="form-group details-input" ng-class="{ \'gift-success\': giftAddrForm[\'name\'].$valid && submitted,\n                                      \'has-error\' : giftAddrForm[\'name\'].$invalid && submitted }"><label for="name" class="col-xs-4 control-label">送　　给</label><div class="col-xs-8"><input type="text" name="name" placeholder="{{giftAddrForm.name.$invalid && submitted?\'昵称未填写\':\'TA的名字\'}}" ng-model="address.name" ng-maxlength="20" required><p ng-show="giftAddrForm.name.$error.maxlength && submitted" class="help-block">昵称字数太多.</p></div></div><div class="form-group details-input" ng-class="{ \'gift-success\': giftAddrForm[\'address\'].$valid && submitted,\n                                      \'has-error\' : giftAddrForm[\'address\'].$invalid && submitted }"><label for="address" class="col-xs-4 control-label">配送地址</label><div class="col-xs-8"><textarea type="address" rows="2" name="address" placeholder="{{giftAddrForm.address.$invalid && submitted?\'配送地址未填写\':\'[送你]盒子飞奔到这里\'}}" ng-model="address.address" class="msd-elastic" required></textarea><p ng-show="giftAddrForm.address.$error.maxlength" class="help-block">配送地址字数太多.</p></div></div><div class="form-group details-input" ng-class="{ \'gift-success\': giftAddrForm[\'telephone\'].$valid && submitted,\n                                      \'has-error\' : giftAddrForm[\'telephone\'].$invalid && submitted }"><label for="telephone" class="col-xs-4 control-label">Ta的电话</label><div class="col-xs-8"><input type="number" name="telephone" placeholder="{{giftAddrForm.telephone.$invalid && submitted?\'手机号未填写\':\'TA的手机号\'}}" ng-model="address.telephone" required phone><p ng-show="giftAddrForm.telephone.$error.phone" class="help-block">不是有效的手机号码.</p></div></div><div class="form-group details-input" ng-class="{\'gift-success\':giftAddrForm[\'name\'].$valid&&giftAddrForm[\'address\'].$valid&&giftAddrForm[\'telephone\'].$valid}"><label for="telephone" class="col-xs-4 control-label">对TA说</label><div class="col-xs-8 text-right"><button type="submit" style="border: 0;background-color: transparent;text-align:right;width:100%"><i class="fa fa-microphone"></i> <i class="fa fa-angle-right"></i></button></div></div></form></div>'),e.put("app/gift/gift.audio.html",'<div><button ng-click="audio.paused ? audio.play() : audio.pause()">暂停</button> <button ng-click="audio.restart()">Stop</button> <button ng-click="audio.muting = !audio.muting">Mute</button><label>时间</label><input class="form-control" type="text" ng-model="audio.currentTime"><label>音量</label><input class="form-control" type="range" min="0" max="1" step="0.01" ng-model="audio.volume"></div>'),e.put("app/gift/gift.detail.html",'<div ui-view=""><div class="present-detail"><div class="present-detail-img"><img ng-src="{{\'http://\' + apiCfg.phtUri + gift.info.cover}}" ng-if="gift.info.cover"> <img ng-src="https://img.91pintuan.com/songli/icon-herf/present_sent_demo.png" ng-if="!gift.info.cover"></div><div class="present-group"><div class="present-detail-summary"><p class="name" ng-bind="gift.info.name"></p><p class="lead" ng-bind="gift.info.lead"></p><div class="separate-box present-summary-bottom"><div class="trade-status-green benedictory-title"><div class="zfy" ng-if="gift.num.pay > 0">{{gift.info.benedictory.title ? gift.info.benedictory.title.replace(\'{NUM}\', (gift.num.receivers || 0)) : \'已有\' + (gift.num.receivers || 0) + \'人收到了礼物\' }}</div><div ng-if="gift.num.pay <= 0"></div></div><div class="separate-left"><span>{{gift.info.price | currency}}</span></div><!--<div class="separate-right trade-status-green">\n                      <div ng-if="gift.info.benedictory.title">\n                          {{ gift.info.benedictory.title.replace(\'{NUM}\', gift.num.subpay || 0) }}\n                      </div>\n                      <div ng-if="!gift.info.benedictory.title">\n                                                已送出 <span ng-bind="gift.num.subpay">0</span>份\n                      </div>\n                  </div>--><div class="clear"></div></div></div></div><div class="height-50"></div><div class="gift-detail"><hr><img class="title-img" src="https://img.91pintuan.com/songli/word_gift_detail.png"><hr class="hr"><div ng-bind-html="trustAsHtml(gift.info.detail)"></div></div><div class="height-60"></div><icon-href theme="grey"></icon-href><div class="height-60"></div></div><!-- Start giving gifts to friends --><div class="bottom-btn double-col btn-left" ng-if=" !gift.num.stock || ((gift.num.stock - gift.num.subpay) > 0) "><!-- type = 1 代表一送一 --> <a ng-if="!gift.num.stock || ((gift.num.stock - gift.num.subpay) > 0)" class="button btn-one" ui-sref="gift.detail.one2one-record({id:gift.id})">送一人</a><!-- type = 2 代表一送多 --> <a ng-if="!gift.num.stock || ((gift.num.stock - gift.num.subpay) > 0)" class="button btn-more" ui-sref="gift.detail.one2many-record({id:gift.id})">送多人</a></div><!-- The gift has been sold out  --><div class="bottom-btn double-col btn-left" ng-if=" !gift.status.online || ( gift.num.stock != 0 && ((gift.num.stock - gift.num.subpay) <= 0) ) " style="background: #8FC31F"><a ng-if="!gift.status.online" class="button btn-ml" ng-disabled="true">抱歉，该商品已售罄</a> <a ng-if="gift.num.stock != 0 && ((gift.num.stock - gift.num.subpay) <= 0)" class="button btn-ml" ng-disabled="true">抱歉，该商品已售罄</a></div></div>'),e.put("app/gift/gift.guide.html",'<div ng-swipe-up="swipe(\'up\')" ng-swipe-down="swipe(\'down\')" ng-style="{height:innerHeight}"><div class="animate-switch" ng-switch on="selection"><div class="animate-switch" ng-switch-when="2"><img src="assets/images/page3.png"></div><div class="animate-switch" ng-switch-when="1"><img src="assets/images/page2.png"></div><div class="animate-switch" ng-switch-default><img src="assets/images/page1.png"></div></div></div><div ng-if="false"><select ng-model="selection" ng-options="item for item in items"></select><code>selection={{selection}}</code><hr><div class="switch-container" ng-switch on="selection"><div class="switch" ng-switch-when="1">Settings Div</div><div class="switch" ng-switch-when="2">Home Span</div><div class="switch" ng-switch-default>default</div></div></div>'),e.put("app/gift/gift.headphones.modal.html",'<div style="margin:200px auto; width:70%"><img ng-src="https://img.91pintuan.com/songli/client/headphones.png" class="img-responsive center-block pull-right" ng-click="close()"></div>'),e.put("app/gift/gift.listen.html",'<div class="listen-container"><div class="empty-line"></div><div class="message-block listen-message-block" style="padding: 0;min-height:{{innerHeight*94/100}}px"><div class="listen-greet"><p>{{order.receiver.name}}:</p><img style="width:100%;margin-top:10px" src="./assets/images/word_receive.png"><p style="text-align: right">{{order.sender.name}}</p><span style="color:#B5B5B6;font-size:15px;text-align: right;margin-top:-6px;display: block">{{order.time.add | date:\'yyyy年MM月dd日 hh:ss\'}}</span></div><div style="background-color:#F7F7F7;padding: 20px"><timer interval="1000" countdown="60" autostart="false"><div class="v"><div class="dialog-bg"><div class="progress"><div class="progress-active" id="pro" aria-valuenow="{{countdown}}" aria-valuemin="0" aria-valuemax="60" style="width: {{progressBar?progressBar:0}}%"></div></div></div><img class="head" ng-src="{{order.sender.headimgurl.replace(\'/0\',\'/46\')}}"><label ng-bind="(60-countdown)+\'s\'"></label></div></timer><div id="play-button" ng-if="media.media_id&&!localId" style="width:28%;margin:20px auto 0"><img src="https://img.91pintuan.com/songli/play.png" ng-click="play()" style="width:100%;margin:0"></div><div ng-if="localId"><div id="pause-button" ng-click="pause()" ng-if="status.play"><img src="https://img.91pintuan.com/songli/pause.png"></div><div id="play-button" ng-click="resume()" ng-if="status.pause"><img src="https://img.91pintuan.com/songli/play.png"></div></div><div id="finish-listen" ng-if="status.stop" ng-click="link()"><img src="https://img.91pintuan.com/songli/down.png" alt="礼物详情"></div></div></div></div>'),e.put("app/gift/gift.lists.html",'<div class="present-list present-lists" infinite-scroll="gifts.nextPage()" infinite-scroll-disabled="gifts.busy" infinite-scroll-distance="1"><div class="present" ng-style="clientWidth && {height: (clientWidth/2 + 44).toFixed(2) + \'px\'}" ng-repeat="gift in gifts.items" ng-click="link()"><div class="present-img" ng-style="clientWidth && {width: (clientWidth/2).toFixed(2) + \'px\', height: (clientWidth/2).toFixed(2) + \'px\'}"><img ng-style="clientWidth && {height: (clientWidth/2 - 20).toFixed(2) + \'px\'}" ng-src="{{\'http://\' + apiCfg.phtUri + gift.info.cover}}" ng-if="gift.info.cover"> <img ng-style="clientWidth && {height: (clientWidth/2 - 20).toFixed(2) + \'px\'}" ng-src="https://img.91pintuan.com/songli/rose_demo.png" ng-if="!gift.info.cover"><div class="present-summary"><span class="present-summary-price">&#165 <span ng-bind="gift.info.price">0</span></span></div></div><div class="gift-info-name"><span ng-bind="gift.info.name | limitTo:10"></span></div></div></div>'),e.put("app/gift/gift.my.html",'<div infinite-scroll="gifts.nextPage()" infinite-scroll-disabled="gifts.busy" infinite-scroll-distance="1"><div class="trade-list" ng-repeat="gift in gifts.items" ng-click="link()"><div class="empty-canvas title"><b><span>送给 </span><span class="trade-name" ng-bind="gift.receiver.name"></span> </b><span class="trade-date" ng-bind="gift.time.add | date:\'yyyy-MM-dd\'"></span></div><div class="empty-canvas trade-content"><img class="trade-img" src="./assets/images/trade_demo.png"><div class="content"><span ng-bind="gift.gift.info.name"></span><br><span>RMB {{gift.gift.info.price}}</span></div></div><div class="empty-canvas trade-content"><b><span class="order-state" ng-if="!gift.status.read" ng-bind="gift.status.shipping?\'已发货\':\'未发货\'"></span> <span class="order-state" ng-if="gift.status.read">已收货</span> </b><span class="num" ng-if="gift.express">快递单号:<span style="color:#FFC125" ng-bind="gift.express"></span></span></div></div></div>'),e.put("app/gift/gift.orders.html",'<div id="last-container"><div class="go-end-page"><div class="go-header"><img src="./assets/images/unknown.png"><br><img style="width:55%;margin-top: 12px" src="./assets/images/word_guide.png"></div><a class="button button-action" ui-sref="gift.detail({id:gift.id})" target="_blank">让礼物帮你说</a><h4 class="go-head-message">已有<span ng-bind="gift.num.pay">0</span>个朋友在用这个特殊礼物表达心声</h4><div class="message-block" id="marquee"><div id="marquee_content"><ul class="show-box"><li ng-repeat="order in orders"><img src="{{order.sender.info.headimgurl.replace(\'/0\',\'/46\')}}"> <span>{{order.sender.info.nickname}}</span> 对 <span>{{order.receiver.name}}</span> 说 <span>...</span></li><li ng-repeat="line in empty_line">&nbsp;</li></ul></div><div id="em"></div></div><p class="go-footer"><img src="./assets/images/word_guide_footer.png"></p></div><div style="background-color:#5D5D5D;min-height:70px"></div></div><script>marquee("marquee","marquee_content","em",60);</script>'),e.put("app/gift/gift.qrcode.html",'<div class="col-md-12 code-margin"><div class="code-you">亲爱的{{order.receiver.name}}:</div><br><div class="text-center code-logo-wai"><div class="text-center code-logo-font">微信扫一扫,听Ta对你说</div><div class="code-logo"><h2>此处是二维码</h2><br><br></div></div><div class="text-center"><div class="text-right code-me"><dl><dd class="">{{order.sender.info.nickname}}</dd><dd class="">{{order.time.add | amCalendar}}</dd></dl></div></div></div>'),e.put("app/gift/gift.share.html",'<div class="section section-last"><div class="show-head"><img class="gift-img" src="https://img.91pintuan.com/songli/icon-herf/present_sent_demo.png" ng-src="{{\'http://\' + apiCfg.phtUri + gift.info.cover}}"><br><span class="gift-name">{{gift.info.name}}</span></div><div class="guide-bottom btn-gift"><div class="double-col"><a class="button btns btn-giftlist" ui-sref="gift.detail({id: gift.id})">我也要送</a></div></div><div class="show-box"><div class="white-box"><span class="box-img"><img src="https://img.91pintuan.com/songli/i.png"></span><!--<span>\n        <span ng-if="gift.info.benedictory.title">{{gift.info.benedictory.title.replace(\'{NUM}\', gift.num.pay)}}</span>\n    \t  <span ng-if="!gift.info.benedictory.title" class="box-r">已有<span>{{gift.num.pay}}</span>人用这个礼物送出了祝福</span>  \n      </span>--> <span class="box-title">{{gift.info.benedictory.title ? gift.info.benedictory.title.replace(\'{NUM}\', gift.num.receivers) : \'已有\' + gift.num.receivers + \'人收到了礼物\' }}</span></div><div class="marquee"><!--<lq-marquee behavior="" direction="upon"></lq-marquee>--><ul class="scroll-box" id="marquee_content"><li ng-repeat="suborder in suborders"><img src="{{suborder.headimgurl.replace(\'/0\',\'/46\')}}"> <span>{{ gift.info.benedictory.content ? gift.info.benedictory.content.replace(\'{RECEIVER}\', (suborder.name).slice(0, 1) + \'** \' || (suborder.consignee).slice(0, 1) + \'** \') : (( (suborder.name).slice(0, 1) || (suborder.consignee).slice(0, 1) ) + \'** 收到了礼物\') }}</span></li></ul></div></div><!--底标--><div class="icon-hrer" style="width: {{screen.width - 10}}px"><icon-href theme="white"></icon-href></div></div>'),e.put("app/gift/gift.share.modal.html",'<style>.share{\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background: rgba(0,0,0,0.6);\n  }</style><div class="share" id="share" ng-click="$dismiss()"><img ng-src="{{shareSrc}}" src="assets/images/share.png" ng-style="shareStyle" class="img-responsive pull-right share-guide"></div><script>var oShare = document.getElementById("share");\n  oShare.style.height = screen.height + \'px\';</script>'),e.put("app/gift/gift.voice.html",'<div class="tape-margin"><div class="text-center tape-logo-wai"><div class="tape-logo" ng-bind-html="gift.info.poetry | nl2br"></div></div><div class="text-center tape-down"><div class="tape-bar"><timer interval="1000" countdown="60" autostart="false"><div class="progress gift-progress"><div class="progress-bar progress-bar-danger progress-bar-striped {{displayProgressActive}}" role="progressbar" aria-valuenow="{{countdown}}" aria-valuemin="0" aria-valuemax="60" style="width: {{progressBar}}%"></div></div><div class="center gift-second">{{countdown === 60?\'&nbsp;\':(60-countdown)+\'S\'}}</div></timer></div><div class="tape-ok"><dl ng-if="status.stop"><dd class="tape-dd-big-star"><img src="https://img.91pintuan.com/songli/record.png" ng-click="record()" class="gift-voice-big"></dd><dd class="tape-dd-big-font">读诗/表白</dd></dl><dl ng-if="status.start"><dd class="tape-dd-big-star"><img src="https://img.91pintuan.com/songli/re_stop.png" ng-click="stop()" class="gift-voice-big"></dd><dd class="tape-dd-big-font">结束录音</dd></dl><div class="tape-poa-btn" ng-if="status.record"><dl class="tape-poa-left"><dd class="tape-dd-small"><img src="https://img.91pintuan.com/songli/play.png" ng-click="playVoice()" class="gift-voice-small"></dd><dd class="tape-dd-big-font">播放</dd></dl><dl class="tape-next tape-poa-left"><dd class="tape-dd-big-over"><img src="https://img.91pintuan.com/songli/next_step.png" ng-click="save()" class="gift-voice-big"></dd><dd class="tape-dd-big-font">下一步</dd></dl><dl class="tape-poa-left"><dd class="tape-dd-small"><img src="https://img.91pintuan.com/songli/re_record.png" ng-click="record()" class="gift-voice-small"></dd><dd class="tape-dd-big-font">重录</dd></dl></div></div></div></div>'),e.put("app/gift/order.listen.html",""),e.put("app/gift/test.html",'<h3>长按列表</h3><p ng-repeat="item in list" on-long-press="itemOnLongPress(item)" on-touch-end="itemOnTouchEnd(item)">[{{ item }}]</p><h3>长按结果</h3><p ng-repeat="msg in messages">{{msg}}</p>'),e.put("app/login/login.html",'<div class="text-center" style="margin-top:100px"><img src="assets/images/icon48_wx_button.png" ng-click="wechat()"></div>'),e.put("app/main/info.html",'<div class="info_container"><div class="info_header" ng-style="clientWidth && {height: (clientWidth*0.8 + 100).toFixed(2) + \'px\'}"><img ng-style="clientWidth && {width: (clientWidth/2.5).toFixed(2) + \'px\', height: (clientWidth*0.8).toFixed(2) + \'px\'}" ng-src="https://img.91pintuan.com/songli/icon-herf/info_header_logo.png" alt=""></div><div class="info_content"><div><img ng-src="https://img.91pintuan.com/songli/icon-herf/info_content1.png"></div><br><!--<p class="info_secondary_title">商家自己的微信送礼平台</p>\n\t\t<p class="info_primary_title">无需开发，免费试用</p>\n\t\t<p class="info_text">开通服务 或了解详情</p>\n\t\t<p class="info_text">请移步电脑端登录</p>\n\t\t<p class="primary_color">wx.91songni.cc</p>\n\t\t<p><span class="info_text">联系电话</span><b class="primary_color">18600083520</b></p>--></div></div>'),e.put("app/main/main.html",'<div ng-include="\'components/navbar/navbar.html\'"></div><header class="hero-unit" id="banner"><div class="container"><h1>\'Allo, \'Allo!</h1><p class="lead">Kick-start your next web app with Angular Fullstack</p><img src="assets/images/yeoman.png" alt="I\'m Yeoman"></div></header><div class="container"><div class="row"><div class="col-lg-12"><h1 class="page-header">Features:</h1><ul class="nav nav-tabs nav-stacked col-md-4 col-lg-4 col-sm-6" ng-repeat="thing in awesomeThings"><li><a href="#" tooltip="{{thing.info}}">{{thing.name}}</a></li></ul></div></div></div><footer class="footer"><div class="container"><p>Angular Fullstack v2.0.13 | <a href="https://twitter.com/tyhenkel">@tyhenkel</a> | <a href="https://github.com/DaftMonk/generator-angular-fullstack/issues?state=open">Issues</a></p></div></footer>'),e.put("app/wechat/app.html",'<a href="wechat:" ng-click="try_to_open_app()">App name</a>'),e.put("app/wechat/pay.html",'<div class="text-center"><h3 style="margin-top:100px;color:#595757;font-size:18px">支付连接中</h3><div class="loading2"><div></div><div></div><div></div><div></div></div></div><div class="paydiv text-center" style="clear:both"><p class="ppay">15秒后未出现支付页面，请点击刷新</p><button class="reflash btn btn-primary btn-lg" ng-click="reflash()">刷新</button><div></div></div>'),e.put("components/icon-href/icon-href.html","<div class=\"icon-href-container\" ng-style=\"theme && (theme === 'grey') && {background: '#F2F2F2'} || {background: '#8fc31f'}\"><a ui-sref=\"info\"><img ng-src=\"{{'https://img.91pintuan.com/songli/icon-herf/' + theme + '_icon.png'}}\" alt=\"logo\"></a></div>"),e.put("components/modal/modal.html",'<div class="modal-header"><button ng-if="modal.dismissable" type="button" ng-click="$dismiss()" class="close">&times;</button><h4 ng-if="modal.title" ng-bind="modal.title" class="modal-title"></h4></div><div class="modal-body"><p ng-if="modal.text" ng-bind="modal.text"></p><div ng-if="modal.html" ng-bind-html="modal.html"></div></div><div class="modal-footer"><button ng-repeat="button in modal.buttons" ng-class="button.classes" ng-click="button.click($event)" ng-bind="button.text" class="btn"></button></div>'),e.put("components/navbar/bottom.html",""),e.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller="NavbarCtrl"><div class="container"><div class="navbar-header"><button class="navbar-toggle" type="button" ng-click="isCollapsed = !isCollapsed"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a href="/" class="navbar-brand">client</a></div><div collapse="isCollapsed" class="navbar-collapse collapse" id="navbar-main"><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href="{{item.link}}">{{item.title}}</a></li></ul></div></div></div>'),e.put("app/gift/order/gift.poi.modal.html",'<div class="poi-address" style="width:{{screen.width}}px; height:{{screen.height}}px" ng-if="pois.length"><div class="list-group address_list" style="min-height: {{screen.height}}px"><a href="#" class="list-group-item poiList" ng-repeat="poi in pois" ng-click="selPoi()"><!--右侧按钮圈--> <span class="poi-com point"></span> <span class="poi-com point1" ng-if="address.poi.id === poi.id"></span><div class="resLeft"><span class="distance" ng-if="poi.distance">{{poi.distance}}km</span><h4 class="list-group-item-heading" ng-bind="poi.base_info.business_name + (poi.base_info.branch_name ? \'(\' + poi.base_info.branch_name + \')\' : \'\')"></h4><p class="list-group-item-text"><span ng-bind="poi.base_info.province"></span> <span ng-bind="poi.base_info.city"></span> <span ng-bind="poi.base_info.district"></span> <span ng-bind="poi.base_info.address"></span></p></div></a></div></div><div></div><div ng-if="!pois.length" class="beyWamp"><div class="beyond"><span>:( 您当前位置距离该商家门店过远</span><br><button class="bey_back" ng-click="$dismiss()">返回{{pois}}</button></div></div>'),
e.put("app/gift/order/gift.receive.form.html",'<form class="form-horizontal" name="$ctrl.giftAddrForm" novalidate ng-submit="$ctrl.saveAddr()"><div class="message-block content content1"><input ng-if="$ctrl.show" class="form-text" type="text" name="consignee" placeholder="收礼人姓名" ng-model="$ctrl.address.consignee" ng-maxlength="20" required><p ng-show="$ctrl.giftAddrForm.consignee.$error.maxlength && $ctrl.submitted" class="help-block">* 收货人字数太多.</p><input ng-if="$ctrl.show" class="form-text" type="tel" name="telephone" placeholder="手机号码" ng-model="$ctrl.address.telephone" required phone><p ng-show="$ctrl.giftAddrForm.telephone.$invalid && $ctrl.submitted" class="help-block">* 请输入有效的手机号码.</p><!--物流收货--><div ng-if="$ctrl.show && (!$ctrl.order.gift.scene || $ctrl.order.gift.scene === \'logistics\')"><textarea rows="2" name="address" style="height:6em" class="form-textarea" placeholder="请留下详细收货地址，确保能收到礼物" ng-model="$ctrl.address.address" ng-maxlength="500" required></textarea><p ng-show="$ctrl.giftAddrForm.address.$error.required && $ctrl.submitted" class="help-block">* 请输入收货人的详细地址.</p><p ng-show="$ctrl.giftAddrForm.address.$error.maxlength && $ctrl.submitted" class="help-block">* 配送地址字数太多.</p></div><!--门店自提--><div ng-if="$ctrl.show && $ctrl.order.gift.scene === \'poi\'" ng-click="$ctrl.selPoi()"><label for="poi">使用门店</label><span>{{ $ctrl.address.poi ? $ctrl.address.poi.base_info.business_name : \'请选择门店\'}}</span> <input type="hidden" name="poi" ng-model="$ctrl.address.poi" required><p ng-show="$ctrl.giftAddrForm.poi.$invalid && $ctrl.submitted" class="help-block">* 请选择门店</p></div><button ng-if="$ctrl.show" type="submit" class="button btn-comm btn-wc btn-green">完成</button> <button ng-if="$ctrl.show && $ctrl.isShare" class="button btn-comm btn-share btn-yellow" ng-click="$ctrl.share()">不知道地址，发给好友填写</button><br></div></form>'),e.put("app/gift/order/gift.receive.status.html",'<!-- 送一个人 --><div class="address-from-friend" ng-show="order.capacity == 1"><!-- 没被领取 --><order-pre-receive ng-if="(!order.receivers || !order.receivers.length || !order.receivers[0].telephone)" order="order" fill="fill" interact="false" share="share"></order-pre-receive><!--[送礼人] [收礼人] 已被领取 再次打开 --><order-received-guide ng-if="order.receivers[0].telephone && isReceived" scene="order.receivers[0].scene" order="order"></order-received-guide><!-- [收礼人] 打开 但是已被他人领取 --><!--宁宁修改  直接跳到结果页面了    (之前是 order-pre-receive) --><order-received-guide ng-if="order.receivers[0].telephone && !isReceived" order="order" fill="fill" interact="false"></order-received-guide></div><!-- 送多个人 --><div ng-if="order.capacity > 1 && !isSender"><!-- 【收礼人】:还没有收礼，而且有余 --><div class="receive-present" ng-if="orderStatus == 1"><order-pre-receive order="order" fill="fill"></order-pre-receive></div><!-- 【收礼人】：已经收礼品了  --><div class="open-link-end" ng-if="(orderStatus == 10) || (orderStatus == 11)"><order-received-guide order="order" fill="fill"></order-received-guide></div><!-- 【收礼人】:还没有收礼，但是礼物已经没有了   --><div class="open-link-end" ng-if="!isSender && orderStatus == 0"><order-pre-receive order="order"></order-pre-receive></div><!-- 【送礼人】:打开链接，还有礼物  \n    <div class="open-link" ng-if="(orderStatus == 101) || (orderStatus == 111)">\n    </div> --><!-- 【送礼人】:打开链接，已经送光了   \n    <div class="open-link-end" ng-if="(orderStatus == 100) || (orderStatus == 110)">\n    </div> --></div>'),e.put("app/gift/order/merchant.info.html",'<div class="merchant-info" id="merchant" ng-click="$dismiss()"><div class="merchant-pubno" id="pubno"><div class="pubno"><span><img width="50px" ng-src="{{ merchant.pubno.head_img }}"></span><span>{{merchant.pubno.nick_name}}</span></div><div class="pubno"><span>联系人</span> <span>{{merchant.info.linkman}}</span></div><div class="pubno"><span>联系商家</span> <span>{{merchant.info.phone ? merchant.info.phone : merchant.info.telephone}}</span></div><div class="pubno"><span>官方微信</span> <span>{{merchant.pubno.nick_name}}</span></div></div><!--<div class="icon-hrer">\r\n    <icon-href theme="white"></icon-href>\r\n  </div>--></div><script>var oMerchant = document.getElementById("merchant");\r\n  var oPubno = document.getElementById("pubno");\r\n  oMerchant.style.height = screen.height + \'px\';\r\n  oPubno.style.height = (screen.height-200) +  \'px\';</script>'),e.put("app/gift/order/order.interact.html",'<div ng-if="($ctrl.order.capacity > 1) && $ctrl.order.receivers && $ctrl.order.receivers.length " class="interact"><p>{{ $ctrl.order.receivers.length }}人已领取 ，<span ng-if="$ctrl.remainCount === 0 ">礼物已经领完</span><span ng-if="$ctrl.remainCount !== 0 ">还有{{ $ctrl.remainCount }}份</span></p><ul><li ng-repeat="receiver in $ctrl.order.receivers | orderBy: \'-id\'"><img ng-src="{{receiver.headimgurl}}"> <span class="receiver-name">{{ receiver.name || receiver.consignee }} </span><span class="font">已领取</span> <span class="date">{{ receiver.fillinDate | date:\'MM-dd HH:mm:ss\'}}</span></li></ul></div>'),e.put("app/gift/order/order.pre.receive.html",'<div ng-if="$ctrl.one2oneLogisticsSender"><order-receive order="$ctrl.order" is-share="true" address="$ctrl.address"></order-receive></div><div ng-if="!$ctrl.one2oneLogisticsSender" class="container-status pre-receive"><!--icon.logo.right--> <img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{$ctrl.order.sender.info.headimgurl}}"></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{$ctrl.order.sender.info.nickname}}送给你一份礼物</span></div><!--礼物领取过程--><div ng-if="$ctrl.isAvailable"><!--单人--><div ng-if="$ctrl.type === \'one2one\'" class="head-prompt"><div ng-if="$ctrl.isSender"><span>已购买成功</span><br><span>开始送礼吧</span></div><div ng-if="$ctrl.isReceiver"><span>请尽快领取</span><br><span ng-if="$ctrl.order.gift.scene === \'poi\'">领取后到店使用</span><p ng-if="$ctrl.order.gift.scene === \'logistics\'">领取后将快递配送</p></div></div><!--多人--><div ng-if="$ctrl.type === \'one2many\'" class="head-main head-title-green"><p class="left-count">还有{{$ctrl.availableCount}}份</p><p class="head-send-status">{{$ctrl.receivedCount}}人已领取</p></div></div><div ng-if="!$ctrl.isAvailable" class="head-prompt"><div ng-if="$ctrl.type === \'one2one\'"><span>礼物已被抢完</span><br>{{$ctrl.order.receivers[0].name}}</div><div ng-if="$ctrl.type === \'one2many\'"><span>礼物已被抢完</span><br><span>{{$ctrl.receivedCount}}人已领取</span></div></div><!--礼物说明--><div ng-if="$ctrl.isSender" class="head-content"><p class="receive-present-text">{{$ctrl.order.sender.info.nickname}}为你准备了一份礼物：{{$ctrl.order.gift.info.name}}。并对你说了一段话，赶快领取吧！</p><div ng-if="$ctrl.isAvailable"><a class="button btn-bg btn-fill" ng-click="$ctrl.share()">送给朋友</a></div><div ng-if="!$ctrl.isAvailable"><a href="gift.list" class="button btn-bg btn-fill">继续送礼</a></div></div><div ng-if="$ctrl.isReceiver" class="head-content"><p class="receive-present-text">{{$ctrl.order.sender.info.nickname}}为你准备了一份礼物：{{$ctrl.order.gift.info.name}}。并对你说了一段话，赶快领取吧！</p><div ng-if="$ctrl.isAvailable"><a href="#" class="button btn-bg btn-fill" ng-click="$ctrl.fill()">领取礼物</a></div><div ng-if="!$ctrl.isAvailable"><a ui-sref="gift.detail({id: $ctrl.order.gift.id})" class="button button-success btn-fill button-yellow">我也要送</a></div><span class="receive-more-poi" ng-if="$ctrl.type === \'one2many\' && $ctrl.order.gift.scene === \'poi\'  ">领取后到店使用</span></div></div><order-interact ng-if="$ctrl.isInteract" order="$ctrl.order"></order-interact><!--底标--><div class="icon-hrer"><icon-href theme="white"></icon-href></div></div>'),e.put("app/gift/order/order.receive.html",'<div class="container-status"><order-receive-poi ng-if="$ctrl.scene === \'poi\' && !$ctrl.poiDisabled" order="$ctrl.order" address="$ctrl.address" save-addr="$ctrl.saveAddr"></order-receive-poi><order-receive-logistics ng-if="$ctrl.scene === \'logistics\' && !$ctrl.logisticsDisabled" order="$ctrl.order" address="$ctrl.address" save-addr="$ctrl.saveAddr" is-share="$ctrl.isShare"></order-receive-logistics></div>'),e.put("app/gift/order/order.receive.logistics.html",'<!--礼logo--> <img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{$ctrl.order.sender.info.headimgurl}}"></div><div class="blackBox"></div><div class="pre-main"><!--礼物说明--><div class="head-content content-addr"><p ng-if="$ctrl.isShare" class="receive-present-text">已经完成支付！想要送给谁写下收礼人的收货信息；不知道地址可以直接发给对方填写</p><p ng-if="!$ctrl.isShare" class="receive-present-text">你的朋友{{$ctrl.order.sender.info.nickname}}为你准备了一份礼物，并对你说了一段话表达祝福。赶快领取吧，写下地址收到礼物时扫描二维码听Ta对你说 ~</p></div></div><!--form表单--><form class="form-horizontal form-addr" name="$ctrl.giftAddrForm" novalidate ng-submit="$ctrl.saveAddr($ctrl)"><div class="form-cont"><input class="form-text" type="text" name="consignee" placeholder="收礼人姓名" ng-model="$ctrl.address.consignee" ng-maxlength="20" required><p ng-show="$ctrl.giftAddrForm.consignee.$error.maxlength && $ctrl.submitted" class="help-block">* 收货人字数太多.</p><input class="form-text" type="tel" name="telephone" placeholder="手机号码" ng-model="$ctrl.address.telephone" required phone><p ng-show="$ctrl.giftAddrForm.telephone.$invalid && $ctrl.submitted" class="help-block">* 请输入有效的手机号码.</p><!--物流收货--><div ng-if="(!$ctrl.order.gift.scene || $ctrl.order.gift.scene === \'logistics\')"><textarea rows="2" name="address" style="height:6em" class="form-textarea" placeholder="请留下详细收货地址，确保能收到礼物" ng-model="$ctrl.address.address" ng-maxlength="500" required></textarea><p ng-show="$ctrl.giftAddrForm.address.$error.required && $ctrl.submitted" class="help-block">* 请输入收货人的详细地址.</p><p ng-show="$ctrl.giftAddrForm.address.$error.maxlength && $ctrl.submitted" class="help-block">* 配送地址字数太多.</p></div><button type="submit" class="button btn-comm btn-wc btn-green">完成</button> <button ng-if="$ctrl.isShare" class="button btn-comm btn-share btn-yellow" ng-click="$ctrl.share()">不知道地址，发给好友填写</button><br></div></form>'),e.put("app/gift/order/order.receive.poi.html",'<div class="poi-receive" id="poi"><!--宽度：{{document.width}}--><!--gift information--><div class="gift-info"><div class="info"><span class="fl"><img ng-src="{{\'//\' + $ctrl.appConfig.phtUri + $ctrl.order.gift.info.cover}}"></span><span class="fl">礼品</span> <span style="width: {{(document.width*0.8) - 70}}px" class="fr" ng-bind="$ctrl.order.gift.info.name"></span></div></div><div class="prompt"><!--<span>请填写信息后到店使用</span>--> <span style="width: {{document.width/2}}px"><img src="https://img.91pintuan.com/songli/client/receive-step-1.png" alt=""></span></div><!--form表单--><form class="form-recpoi" name="$ctrl.giftAddrForm" novalidate ng-submit="$ctrl.saveAddr($ctrl)"><!--姓名--><div class="form-common form-name"><label class="form-label fl">姓名</label><input class="fr" type="text" name="consignee" placeholder="收礼人姓名" ng-model="$ctrl.address.consignee" ng-maxlength="20" required><p ng-show="$ctrl.giftAddrForm.consignee.$error.maxlength && $ctrl.submitted" class="help-block">* 收货人字数太多.</p></div><!--手机号--><div class="form-common form-tel"><label class="form-label fl">手机号</label><input class="fr" type="tel" name="telephone" placeholder="手机号码" ng-model="$ctrl.address.telephone" required phone><p ng-show="$ctrl.giftAddrForm.telephone.$invalid && $ctrl.submitted" class="help-block">* 请输入有效的手机号码.</p></div><!--门店自提--><div class="form-common form-poi" ng-click="$ctrl.selPoi()"><label class="label-poi fl" for="poi">使用门店</label><span class="fl poi" ng-if="!$ctrl.poiLoaded">门店加载中</span> <span class="fl poi" ng-if="$ctrl.poiLoaded">{{ $ctrl.address.poi ? $ctrl.address.poi.base_info.business_name : \'请选择门店\'}}</span> <input type="hidden" name="poi" ng-model="$ctrl.address.poi" required> <span class="fr right"><img src="https://img.91pintuan.com/songli/client/poi-right.png" alt=""></span><p ng-show="$ctrl.giftAddrForm.poi.$invalid && $ctrl.submitted" class="help-block">* 请选择门店</p></div><button type="submit" class="button btn-comm btn-wc btn-green btn-poi">下一步</button> <button ng-if="$ctrl.isShare" class="button btn-comm btn-share btn-yellow btn-spoi" ng-click="$ctrl.share()">不知道地址，发给好友填写</button></form></div><!--底标--><div class="icon-hrer"><icon-href theme="white"></icon-href></div>'),e.put("app/gift/order/order.received.guide.html",'<div class="container-status pre-receive"><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{$ctrl.order.sender.info.headimgurl}}"></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{$ctrl.order.sender.info.nickname}}的礼物</span><br></div><!--礼物领取过程--><!--单人--><div class="head-prompt" ng-if="$ctrl.order.capacity === 1"><!--送礼人--><div ng-if="$ctrl.isSender"><p class="left-count">{{ $ctrl.order.receivers[0].consignee }}</p><p class="head-send-status">已经领取了你的礼物</p></div><!--收礼人--><div ng-if="$ctrl.isReceiver"><p class="left-count">你已领取礼物</p><p class="head-send-status" ui-sref="order.detail.received-result({id: $ctrl.order.id})">查看礼物详情</p></div><!--其他人--><div ng-if="!$ctrl.isSender && !$ctrl.isReceiver && $ctrl.receivedAll"><p class="left-count">礼物已被抢完</p><p class="head-send-status">{{$ctrl.order.receivers[0].name}}领取了礼物</p><div class="head-content head-other"><p class="receive-present-text">{{$ctrl.order.sender.info.nickname}}为你准备了一份礼物：{{$ctrl.order.gift.info.name}}。并对你说了一段话，赶快领取吧！</p></div></div></div><!--多人--><div ng-if="$ctrl.order.capacity > 1" class="head-main head-title-green"><p class="left-count">你已领取礼物</p><p class="head-send-status" ui-sref="order.detail.received-result({id: $ctrl.order.id})">查看礼物详情</p></div><!--礼物说明--><div class="head-content"><div ng-if="$ctrl.isSender"><p>您已成功购买{{$ctrl.order.gift.info.name}}; 自己领取或转发送给好友。</p><a ui-sref="gift.list" class="button btn-bg btn-fill button-yellow">继续送礼</a></div><div ng-if="$ctrl.isReceiver"><p class="receive-present-text">你已成功领取{{$ctrl.order.sender.info.nickname}}的礼物。使用时请到你所选择的对应门店，点击立即使用将二维码消费凭证出示给商家，即可领取礼物。</p><p class="receive-vcode"><span><img src="https://img.91pintuan.com/songli/client/vcode-icon.png"></span><span>到店使用时请向商家出示二维码</span></p><div class="btn-group"><a ui-sref="order.detail.received-result({id: $ctrl.order.id})" class="button btn-bg btn-green">立即使用</a> <a ui-sref="gift.detail({id: $ctrl.order.gift.id})" class="button btn-bg btn-yellow">我也要送</a></div></div><div ng-if="!$ctrl.isSender && !$ctrl.isReceiver && $ctrl.receivedAll"><div class="btn-group"><a ui-sref="gift.detail({id: $ctrl.order.gift.id})" class="button btn-bg button-yellow btn-logistic">我也要送</a></div></div></div><order-interact ng-if="$ctrl.order.capacity > 1" order="$ctrl.order"></order-interact></div><div class="icon-hrer"><icon-href theme="white"></icon-href></div></div>'),e.put("app/gift/order/order.received.html",'<div class="container-status" id="received"><!--【物流】--><div ng-if="$ctrl.scene === \'logistics\'"><!--送单人，礼物领取后后再次打开链接--><div ng-if="$ctrl.order.capacity === 1" class="onecapacity"><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{$ctrl.order.sender.info.headimgurl}}"><br></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{$ctrl.order.sender.info.nickname}}的礼物</span><br></div><div class="head-prompt"><span>礼物已被领取</span><br><span>等待商家发货</span></div><div class="cont-info"><p><label>收礼人:</label><span>{{ $ctrl.order.receivers[0].consignee }}</span></p><p><label>手机号:</label><span>{{ $ctrl.order.receivers[0].telephone }}</span></p><p><label>地&nbsp;&nbsp;&nbsp;&nbsp;址:</label><span>{{ $ctrl.order.receivers[0].address }}</span></p></div><div class="footer-btn"><!--送礼人打开的id = 微信用户的id--><!--<icon-href theme="white"></icon-href>--> <a ng-if="$ctrl.isSender" ui-sref="gift.list" class="btn-receive button-success btn-logistic">继续送礼</a> <a ng-if="!$ctrl.isSender" ui-sref="gift.detail({id: $ctrl.order.gift.id})" class="btn-receive button-success btn-logistic">我也要送</a></div></div></div><!--送多人--><div ng-if="$ctrl.order.capacity > 1"><!--icon.logo.right--> <img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><!--送礼人头像--><div class="greyBox"></div><div class="head-center"><img ng-src="{{$ctrl.order.sender.info.headimgurl}}"><br></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{$ctrl.order.sender.info.nickname}}的礼物</span><br></div><div class="head-prompt"><span>礼物已被领取</span><br><span ng-if="$ctrl.order.receivers && ($ctrl.order.receivers.length != $ctrl.order.capacity)"><!--还有{{orderSurplus}}份--> 还有{{$ctrl.order.capacity - $ctrl.order.receivers.length}}份 </span><span ng-if="$ctrl.order.receivers && ($ctrl.order.receivers.length === $ctrl.order.capacity)">礼物已被领完</span></div><div class="head-content"><p class="receive-present-text">你已成功领取{{$ctrl.order.sender.info.nickname}}的礼物，等待商家发货吧。不要忘了除了礼物{{$ctrl.order.sender.info.nickname}}还对你说了一段话，收到礼物时扫描语音码，听听ta都说了些什么吧。</p><a ui-sref="gift.detail({id: $ctrl.order.gift.id})" class="button button-success btn-logistic">我也要送</a></div></div></div></div><!--【门店】--><div ng-if="$ctrl.scene === \'poi\'" class="poi-received"><!--送礼人--><div ng-if="$ctrl.isSender && $ctrl.order.capacity === 1"><div class="onecapacity"><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{$ctrl.order.sender.info.headimgurl}}"><br></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{ $ctrl.order.sender.info.nickname }}的礼物</span><br></div><div class="head-prompt"><span>{{ $ctrl.order.receivers[0].consignee }}</span><br><span>领取了你的礼物</span></div><div>您已成功购买1份{{ $ctrl.order.gift.info.name }}；自己领取或者转发送给好友</div><div class="footer-btn"><!--送礼人打开的id = 微信用户的id--><!--<icon-href theme="white"></icon-href>--> <a ui-sref="gift.list" class="button">继续送礼</a></div></div></div></div><!--收礼人或者其他人--><div ng-if="!$ctrl.isSender"><div class="gift-info" ui-sref="gift.detail.share({id: $ctrl.order.gift.id})"><div class="info"><span class="fl"><img ng-src="//{{$ctrl.appConfig.phtUri + $ctrl.order.gift.info.cover}}" alt=""></span><span class="fl">礼品</span> <span class="fr" style="width: {{(document.width*0.8) - 70}}px" ng-bind="$ctrl.order.gift.info.name"></span></div></div><!--使用状态--><div class="use-state" ng-if="$ctrl.suborder"><span>礼物券已被领取</span> <span ng-bind="$ctrl.suborder.status.shipping ? \'已使用\' : \'未使用\' "></span></div><!--二维码--><div class="gift-code" ng-if="$ctrl.suborder"><span><img ng-src="{{ $ctrl.suborder.qrcode.src }}"></span><span>{{ $ctrl.suborder.id }}</span> <span>请保留二维码消费凭证</span> <span>到店使用时请向商家出示二维码</span></div><!--领取信息--><div class="rec-info" ng-if="$ctrl.suborder"><ul><li ng-click="openMerchant()"><div class="rec-l fl"><span>联系商家</span> <span>{{ $ctrl.$rootScope.merchant.pubno.nick_name }}</span></div><div class="rec-r fl"><img class="merchant" ng-src="{{ $ctrl.$rootScope.merchant.pubno.head_img }}"> <img class="icon-r fr" src="http://91pt.oss-cn-beijing.aliyuncs.com/songli/client/received.png"></div></li><li ng-click="$ctrl.openLocation($ctrl.suborder.poi)"><div class="rec-l fl"><span>自提门店</span> <span>{{ $ctrl.suborder.poi.base_info.business_name }}</span></div><div class="rec-r fl"><img class="poi-icon" src="http://91pt.oss-cn-beijing.aliyuncs.com/songli/client/received-address.png"> <img class="icon-r fr" src="http://91pt.oss-cn-beijing.aliyuncs.com/songli/client/received.png"></div></li><li><div class="clear"></div><div class="rec-l"><span>领取人信息</span> <span>{{ $ctrl.suborder.consignee + \' \' + $ctrl.suborder.telephone }}</span></div></li></ul></div><div class="nogift" ng-if="!$ctrl.suborder"><span>礼物已被抢完</span> <span>{{$ctrl.order.receivers.length}}人已经领取</span><p>您已成功购买{{$ctrl.order.capacity}}份{{$ctrl.order.gift.info.name}},发至到微信好友/微信群或朋友圈,开始送礼吧！</p><a href="#" class="button btn-bg btn-fr btn-gary">礼物已被抢完</a></div></div></div></div><!--interact--><order-interact ng-if="($ctrl.order.capacity > 1) && $ctrl.order.receivers && $ctrl.order.receivers.length && ($ctrl.order.gift.scene && $ctrl.order.gift.scene === \'logistics\')" order="$ctrl.order"></order-interact><div class="icon-hrer"><icon-href theme="white"></icon-href></div>'),e.put("app/gift/order/order.subscribe.html",'<div class="poi-receive subscribe" id="subscribe"><!--宽度：{{$ctrl.$window.innerHeight}}--><!--gift information--><div class="gift-info"><div class="info"><span class="fl"><img ng-src="{{\'//\' + $ctrl.appConfig.phtUri + $ctrl.order.gift.info.cover}}"></span><span class="fl">礼品</span> <span style="width: {{($ctrl.$subscribeWidth*0.8) - 70}}px" class="fr" ng-bind="$ctrl.order.gift.info.name"></span></div></div><div class="step"><img src="https://img.91pintuan.com/songli/client/receive-step-2.png" alt=""></div><div class="guidance"><span>长按二维码关注公号</span> <span>公号将会发送礼物消费凭证</span></div><div class="merchant-code" style="width: {{$ctrl.$subscribeWidth/2 + 40}}px; height: {{$ctrl.$subscribeWidth/2 + 40}}px"><!--商家二维码--><div class="code" style="width: {{$ctrl.$subscribeWidth/2 + 40 }}px"><img ng-if="$ctrl.qrcode" ng-src="{{ \'https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket=\' + $ctrl.qrcode}}"></div><div class="radius"><img src="https://img.91pintuan.com/songli/client/top.png" alt=""> <img src="https://img.91pintuan.com/songli/client/right.png" alt=""> <img src="https://img.91pintuan.com/songli/client/bottom.png" alt=""> <img src="https://img.91pintuan.com/songli/client/left.png" alt=""></div></div><div class="past"><span>如已关注，公号已经发送</span></div></div><!--底标--><div class="icon-hrer"><icon-href theme="white"></icon-href></div>'),e.put("app/gift/orderlist/order.info.html",'<!-- 单人订单 --><div class="present-sent-detail listgift" ng-show="order.capacity == 1"><div class="card-group"><div class="detail-title"><div class="detail-title-img"><img ng-src="{{\'http://\' + apiCfg.phtUri + order.gift.info.cover}}" class="od-trade-img" ng-if="order.gift.info.cover"> <img src="https://img.91pintuan.com/songli/icon-herf/present_sent_demo.png" class="od-trade-img" ng-if="!order.gift.info.cover"></div><div class="detail-title-content"><p class="giftname">{{order.gift.info.name}}</p><!--<p>单价：{{order.gift.info.price}}元/份</p>--></div></div></div><div class="box-list"></div><div class="card-group2"><ul class="card detail-content"><li class="card-li"><span class="listInfo">单价：</span> <span class="listorder">{{order.gift.info.price | currency}}</span></li><li class="clear"></li><li class="card-li"><span class="listInfo">数量：</span> <span class="listorder">{{order.capacity}}份</span></li><li class="clear"></li><li class="card-li"><span class="listInfo">总价：</span> <span class="listorder">{{order.gift.info.price * order.capacity | currency}}</span></li><li class="clear"></li><li class="card-li"><span class="listInfo">下单时间：</span> <span class="listorder listorder2">{{order.time.add | date:\'yyyy-MM-dd HH:MM:ss\'}}</span></li><li class="clear"></li><li class="card-li" ng-if="order.express"><span class="listInfo">快递单号:</span> <span class="listorder listorder2" ng-bind="order.receivers[0].express.no"></span></li><li class="clear"></li></ul></div><!-- #TODO leave order stauts to https://github.com/arrking/songni/issues/74 --><!--礼物状态--><div class="card-group3"><ul class="detail-status"><li ng-if="true"><span class="state">礼物状态</span></li><li ng-if="receiver.status.read" class="receiver"><span class="name">{{receiver.status.read_date | date:\'yyyy-MM-dd HH:mm:ss\'}}</span> <span class="status status-listen">已收货</span></li><li ng-if="receiver.status.shipping" class="receiver"><span class="name">{{receiver.status.shipping_date | date:\'yyyy-MM-dd HH:mm:ss\'}}</span> <span class="status status-deliver">已发货</span></li><li ng-if="receiver && receiver.telephone" class="receiver"><span class="name">{{receiver.fillinDate | date:\'yyyy-MM-dd HH:mm:ss\'}}</span> <span class="status status-deliver">已领取</span></li><li class="receiver"><span class="name">{{receiver && order.time.pay | date:\'yyyy-MM-dd HH:mm:ss\'}}下单</span> <a ng-if="receiver && receiver.telephone" ui-sref="order.detail.one2one-address({id: order.id})" class="status status-deliver">礼物已被领取 <img class="spanimg" src="assets/images/right.png" alt=""></a><a ng-if="!receiver || !receiver.telephone" ui-sref="order.detail.one2one-address({id: order.id})" class="status status-deliver">1份礼物未被领取 <img class="spanimg" src="assets/images/right.png" alt=""></a></li></ul></div></div><!-- 多人订单 --><div class="present-sent-detail listgift" ng-show="order.capacity > 1"><div class="card-group"><div class="detail-title"><div class="detail-title-img"><img ng-src="{{\'http://\' + apiCfg.phtUri + order.gift.info.cover}}" class="od-trade-img" ng-if="order.gift.info.cover"> <img src="https://img.91pintuan.com/songli/icon-herf/present_sent_demo.png" class="od-trade-img" ng-if="!order.gift.info.cover"></div><div class="detail-title-content"><p class="giftname">{{order.gift.info.name}}</p><!--<p>单价：{{order.gift.info.price}}元/份</p>--></div></div></div><div class="box-list"></div><div class="card-group2"><ul class="card detail-content"><li class="card-li"><span class="listInfo">单价：</span> <span class="listorder">{{order.gift.info.price | currency}}</span></li><li class="clear"></li><li class="card-li"><span class="listInfo">数量：</span> <span class="listorder">{{order.capacity}}份</span></li><li class="clear"></li><li class="card-li"><span class="listInfo">总价：</span> <span class="listorder">{{order.gift.info.price * order.capacity | currency}}</span></li><li class="clear"></li><li class="card-li"><span class="listInfo">下单时间：</span> <span class="listorder listorder2">{{order.time.add | date:\'yyyy-MM-dd HH:MM:ss\'}}</span></li><li class="clear"></li><li class="card-li" ng-if="order.express"><span class="listInfo">快递单号:</span> <span class="listorder listorder2" ng-bind="order.receivers[0].express.no"></span></li><li class="clear"></li></ul></div><!--礼物状态--><div class="card-group3"><!-- #TODO leave order stauts to https://github.com/arrking/songni/issues/74 --><ul class="detail-status"><li ng-if="listen_num || ship_num || receive_num"><span class="state">礼物状态</span></li><li class="receiver" ng-if="listen_num != 0"><span class="trade-time">{{readTime | date:\'yyyy-MM-dd HH:mm:ss\'}}</span><div class="trade-num trade-status-yellow" ng-click="listened()">已收货 {{listen_num}} <img class="spanimg" src="assets/images/right.png" alt=""></div></li><li class="receiver" ng-if="ship_num != 0"><span class="trade-time">{{shippedTime | date:\'yyyy-MM-dd HH:mm:ss\'}}</span><div class="trade-num trade-status-green" ng-click="shipped()">已发货 {{ship_num}} <img class="spanimg" src="assets/images/right.png" alt=""></div></li><li class="receiver" ng-if="receive_num != 0"><span class="trade-time">{{receivedTime | date:\'yyyy-MM-dd HH:mm:ss\'}}</span><div class="trade-num trade-status-green" ng-click="received()">已领取 {{receive_num}} <img class="spanimg" src="assets/images/right.png" alt=""></div></li><li class="receiver"><span class="trade-time">{{order.time.pay | date:\'yyyy-MM-dd HH:mm:ss\'}}</span><div class="trade-num trade-status-green" ng-click="jumpToAddressCard()">{{order.capacity - receive_num === 0 ? \'礼物已被领完\' : order.capacity - receive_num + \'份礼物未领取\' }} <img class="spanimg" src="assets/images/right.png" alt=""></div></li></ul></div></div>'),e.put("app/gift/orderlist/order.list.html",'<div class="listgift" infinite-scroll="gifts.nextPage()" infinite-scroll-disabled="gifts.busy" infinite-scroll-distance="1"><div ng-repeat="order in gifts.items" ng-click="link(order.id)" style="margin-top:15px"><!-- 多人订单 --><div class="trade-group" ng-show="order.capacity > 1"><!--<div class="card">\n                <span class="trade-status-green">{{order.receivers.length}}人已领取</span>\n                <span class="trade-date" ng-bind="order.time.add | date:\'yyyy-MM-dd\'"></span>\n            </div>--><div class="card trade-content"><div class="order-header"><div class="header-left"><img class="trade-img" src="https://img.91pintuan.com/songli/icon-herf/present_sent_demo.png" ng-src="{{\'http://\' + apiCfg.phtUri + order.gift.info.cover}}"></div><div class="header-right"><span ng-bind="order.gift.info.name"></span></div></div><div class="order-content"><ul class="orderlist"><li class="list-li"><span class="listname">单价：</span> <span class="listnum">{{order.gift.info.price | currency}}</span> <span class="num">x{{order.capacity}}</span></li><li class="clear"></li><li class="list-li"><span class="listname">支付金额：</span> <span class="listnum">{{order.gift.info.price * order.capacity | currency}}</span></li><li class="clear"></li><li class="list-li"><span class="listname">下单时间：</span> <span class="listnum">{{order.time.add | date:\'yyyy-MM-dd HH:MM:ss\'}}</span></li><li class="clear"></li></ul></div><div class="order-code"><span class="code">订单号 {{order.serial}}</span> <span class="icon-r"><img class="spanimg" src="assets/images/right.png" alt=""></span></div></div></div><!-- 单人订单 --><div class="trade-group" ng-show="order.capacity ==1 "><!--<div class="card">\n                <span>送给 </span>\n                <span class="trade-name">{{order.receivers[0].name}}</span>\n                <span class="trade-date" ng-bind="order.time.add | date:\'yyyy-MM-dd\'"></span>\n            </div>--><div class="card trade-content"><div class="order-header"><div class="header-left"><img class="trade-img" src="https://img.91pintuan.com/songli/icon-herf/present_sent_demo.png" ng-src="{{\'http://\' + apiCfg.phtUri + order.gift.info.cover}}"></div><div class="header-right"><span ng-bind="order.gift.info.name"></span></div></div><div class="order-content"><ul class="orderlist"><li class="list-li"><span class="listname">单价：</span> <span class="listnum">{{order.gift.info.price | currency}}</span> <span class="num">x{{order.capacity}}</span></li><li class="clear"></li><li class="list-li"><span class="listname">支付金额：</span> <span class="listnum">{{order.gift.info.price * order.capacity | currency}}</span></li><li class="clear"></li><li class="list-li"><span class="listname">下单时间：</span> <span class="listnum">{{order.time.add | date:\'yyyy-MM-dd HH:MM:ss\'}}</span></li><li class="clear"></li></ul></div><div class="order-code"><span class="code">订单号 {{order.serial}}</span> <span class="icon-r"><img class="spanimg" src="assets/images/right.png" alt=""></span></div><!--礼物领取状态--><!--<div class="order-state">\n                \t<span class="" ng-if="!order.status.read" ng-bind="order.status.shipping?\'已发货\':\'未发货\'"></span>\n                \t<span class="" ng-if="order.status.read">已收货</span>\n                \t<span class="num" ng-if="order.express">\n                \t\t快递单号:<span style="color:#FFC125;" ng-bind="order.receivers[0].express.no"></span>\n                \t</span>\n                </div>--></div></div></div></div>'),e.put("app/gift/orderlist/order.listened.html",'<div class="present_received_list listgift"><div class="card-group"><div class="card card-ship" ng-repeat="receiver in receivers"><div class="present-rl-item"><img src="http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png" ng-src="{{receiver.headimgurl}}"><div class="ite-summary"><div class="clear"></div><div class="ite-content"><span class="ite-name">{{receiver.consignee}}</span> <span class="ite-status"><span class="trade-status-green">已收货</span></span></div><div><span class="ite-status"><span>{{receiver.status.read_date | date:\'yyyy-MM-dd HH:mm:ss\'}}</span></span></div></div></div><div class="express"><span class="span1">快递单号</span> <span class="span2">{{receiver.express.company.name}} {{receiver.express.no}}</span></div></div></div></div>'),e.put("app/gift/orderlist/order.received.html",'<div class="present_received_list secondpage"><div class="card-group"><div class="card card-received" ng-repeat="receiver in receivers"><div class="present-rl-item"><img src="http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png" ng-src="{{receiver.headimgurl}}"><div class="ite-summary"><div class="clear"></div><div class="ite-content"><span class="ite-name">{{receiver.consignee}}</span> <span class="ite-status"><span class="trade-status-green">已领取</span></span></div><div><span class="ite-status"><span>{{receiver.fillinDate | date:\'yyyy-MM-dd HH:mm:ss\'}}</span></span></div></div></div></div><div class="box-second"></div></div></div>'),
e.put("app/gift/orderlist/order.shipped.html",'<div class="present_received_list listgift"><div class="card-group"><div class="card card-ship" ng-repeat="receiver in receivers"><div class="present-rl-item"><img src="http://7xkeqi.com1.z0.glb.clouddn.com/songni%2F%E5%9B%BE%E7%89%87-%E4%BA%AB%E9%93%BE%E6%8E%A5.png" ng-src="{{receiver.headimgurl}}"><div class="ite-summary"><div class="clear"></div><div class="ite-content"><span class="ite-name">{{receiver.consignee}}</span> <span class="ite-status"><span class="trade-status-green">已发货</span></span></div><div><span class="ite-status"><span>{{receiver.status.shipping_date | date:\'yyyy-MM-dd HH:mm:ss\'}}</span></span></div></div></div><div class="express"><span class="span1">快递单号</span> <span class="span2">{{receiver.express.company.name}} {{receiver.express.no}}</span></div></div></div></div>'),e.put("app/gift/order/one2many/address.fillin.html",'<!-- 一送多填写地址 --><div class="address-from-friend form-friend"><div class="container-status"><!--icon.logo.right--><!--    \t\r\n        <img class="icon-img" src="https://img.91pintuan.com/songli/i.png" />\r\n        <div class="head-fillin">\r\n          <p class="center-mini-text text-color">\r\n             \t写下收货地址，收到礼物时，扫描礼物上的语音二维码听Ta对你说 ~\r\n          </p>\r\n        </div>\r\n      --><order-receive order="order" address="address" save-addr="saveAddr"></order-receive><!--底标--><div class="icon-hrer"><icon-href theme="white"></icon-href></div></div></div>'),e.put("app/gift/order/one2many/address.html",'<!-- 送礼人订单 --><div class="pay-success-several send-many"><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><div class="head-center"><img ng-src="{{order.sender.info.headimgurl}}"></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{order.sender.info.nickname}}的礼物</span><br></div><div class="head-main"><!--礼物已备好--><div ng-if="!order.receivers || !order.receivers.length"><span class="pre-comm">{{order.capacity}}份礼物已备好</span><br><span class="pre-green">开始送礼吧</span></div><!--礼物领取中--><div ng-if="order.receivers && order.receivers.length && order.receivers.length != order.capacity"><span class="pre-comm">还有{{ order.capacity - order.receivers.length }}份</span><br><span class="pre-green">{{ order.receivers.length }}人已领取</span></div><!--礼物已经被抢完--><div ng-if="order.receivers && order.receivers.length && order.receivers.length === order.capacity"><span class="pre-comm">礼物已被抢完</span><br><span class="pre-green">{{ order.receivers.length }}人已领取</span></div></div><!--礼物说明--><div class="head-content"><p class="receive-present-text">您已成功购买{{order.capacity}}份{{order.gift.info.name}},发至到微信好友/微信群或朋友圈,开始送礼吧！</p><!--礼物领取中--> <a href="#" id="start-send-present" ng-if=" !order.receivers || !order.receivers.length || (order.receivers.length && order.receivers.length !== order.capacity) " ng-click="share()" ng-class="{\'btn-no\' :order.receivers.length === order.capacity}" class="button btn-bg btn-fill">{{ order.receivers && order.receivers.length ? \'继续送礼\' : \'开始送礼\' }} </a><!--礼物被抢完时--> <a ui-sref="gift.list" ng-if=" order.receivers && order.receivers.length && order.receivers.length === order.capacity " class="button btn-bg btn-fill button-yellow">继续送礼</a></div></div><!--interact--><order-interact order="order"></order-interact><!--底标--><div class="icon-hrer"><div ng-if="!order.receivers || !order.receivers.length" class="icon-height"></div><icon-href theme="white"></icon-href></div></div>'),e.put("app/gift/order/one2many/pay.html",'<div style="height:8px"></div><div class="empty-canvas empty-pay" ng-controller="GiftPayOne2ManyCtrl"><div class="pay"><div class="card-pay"><div class="present-detail-summary"><p class="name">{{gift.info.name}}</p><p class="lead">{{gift.info.lead}}</p><div class="separate-box present-summary-bottom"><div class="separate-left"><span>{{gift.info.price | currency}}</span></div><div class="separate-right trade-status-h"><span>{{capacity}}份</span></div><div class="clear"></div></div></div></div><div class="card-pay total-pay"><div class="card"><div class="separate-box"><div class="separate-left">总 计</div><div class="separate-right">{{ gift.info.price * capacity | currency }}</div><div class="clear"></div></div></div></div><!--/total-pay--><div class="pay-now"><a class="button btn-pay btn-green" ng-click="wxPay()" ng-disabled="submiting" ng-bind="submiting?\'支付中...\':\'支付\'"></a></div></div></div>'),e.put("app/gift/order/one2many/record.html",'<div class="sound-record sound-more" ng-style="{height:innerHeight-54+\'px\'}"><div class="to-who to-more"><img class="img" src="https://img.91pintuan.com/songli/gift_copies-more.png"><br><div class="to-who-count"><div class="input-group"><!--左减--> <span class="input-group-btn input-left"><button type="button" ng-click="reduCapacity()" class="btn btn-success btn-number btn-left"><span>&minus;</span></button> </span><!--输入框--> <span class="input-middle"><input type="number" ng-model="giftOrderCapacity" pattern="\\d*" class="form-control input-number" placeholder="2" min="2"> </span><!--右加--> <span class="input-group-btn input-right"><button type="button" ng-click="incrCapacity()" class="btn btn-success btn-number" data-type="plus"><span>+</span></button></span></div></div></div><div class="voice-box"><div class="voice-process"><img src="https://img.91pintuan.com/songli/word-zhufu.png"><timer interval="1000" countdown="60" autostart="false"><div class="progress"><div class="progress-active" id="pro" aria-valuenow="{{countdown}}" aria-valuemin="0" aria-valuemax="60" style="width: {{progressBar?progressBar:0}}%"></div></div><span class="label" id="second" style="text-align:right; display: block">{{countdown === 60?\'&nbsp;\':(60-countdown)+\'S\'}}</span></timer></div><!-- 开始录音 --><div id="record-before" ng-if="status.stop"><img src="https://img.91pintuan.com/songli/record.png" ng-click="record()"><br><span class="hint">点击开始录音</span></div><!-- 结束录音 --><div id="record-before" ng-if="status.start"><img src="https://img.91pintuan.com/songli/re_stop.png" ng-click="stop()"><br><span class="hint">结束录音</span></div><!-- 调试录音 --><div id="record-after" ng-if="status.record"><div class="left-button" ng-click="playVoice()"><img src="https://img.91pintuan.com/songli/play_red.png"><br><label class="hint">播放</label></div><div class="left-button" ng-click="rerecord()"><img src="https://img.91pintuan.com/songli/re_record.png"><br><label class="hint">重录</label></div><div class="right-button" ng-click="save()"><img src="https://img.91pintuan.com/songli/next_step.png"><br><label class="hint">下一步</label></div></div></div></div>'),e.put("app/gift/order/one2one/address.fillin.html",'<order-receive ng-if="!order.receivers || !order.receivers.length || !order.receivers[0].telephone" order="order" address="address"></order-receive><order-received ng-if="order.receivers && order.receivers.length && order.receivers[0].telephone" order="order"></order-received>'),e.put("app/gift/order/one2one/address.html",'<!--[送礼人]: 已收礼--><div ng-if="order.receivers.length == 1 && order.receivers[0].telephone" class="one-address"><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{order.sender.info.headimgurl}}"></div><div class="blackBox"></div><div class="head-nickname"><span>{{order.sender.info.nickname}}的礼物</span><br></div></div><!--[送礼人-公众号]再次打开时--><div ng-if="order.receivers.length == 1 && order.receivers[0].telephone" class="message-block"><form class="form-horizontal"><!--<input ng-disabled="true" class="input-msg input-msg1 form-text" type="text" name="consignee" placeholder="收礼人姓名" ng-model="order.receivers[0].consignee">\n      <input ng-disabled="true" class="input-msg input-msg1 form-text" type="tel" name="telephone" placeholder="手机号码" ng-model="order.receivers[0].telephone">\n      <textarea ng-disabled="true" rows="2" name="address" style="height:6em" class="input-msg input-msg1 form-textarea" ng-model="order.receivers[0].address"></textarea>--><div class="state-info"><span>礼物已被领取</span> <span>等待商家发货</span></div><div class="pre-info"><div><span>收礼人：</span><span>{{ order.receivers[0].consignee }}</span></div><div><span>手机号：</span><span>{{ order.receivers[0].telephone }}</span></div><!--物流--><div ng-if="order.receivers[0].address"><span>地&nbsp;&nbsp;&nbsp;&nbsp;址：</span> <span>{{ order.receivers[0].address }}</span></div><!--门店--><div ng-if="order.receivers[0].poi"><span>门店地址：</span> <span>{{ order.receivers[0].poi.base_info.business_name + order.receivers[0].poi.base_info.address}}</span></div></div><div class="footer-btn"><a ui-sref="gift.list" class="btn-receive button-success btn-logistic">继续送礼</a></div></form></div><!--【成功】购买礼物--><div ng-if="order.receivers.length == 1 && !order.receivers[0].telephone" class="gift-purchase"><!--【门店场景】--><div ng-if="order.gift.scene === \'poi\' "><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><div class="greyBox"></div><!--送礼人头像--><div class="head-center"><img ng-src="{{order.sender.info.headimgurl}}"></div><div class="blackBox"></div><div class="pre-main"><div class="head-sender"><span>{{order.sender.info.nickname}}的礼物</span><br></div><div class="head-prompt"><span>已购买成功</span><br><span>开始送礼吧</span></div><div class="head-content"><p class="receive-present-text">您已经成功购买1份{{order.gift.info.name}}；自己领取或转发送给朋友。</p><a href="#" ng-click="share()" class="button btn-bg btn-fr">送给朋友</a></div></div></div><!--【物流场景】--><order-receive order="order" address="address" is-share="true" poi-disabled="true"></order-receive><!--<div ng-if=" order.gift.scene === \'logistics\' ">\r\n\t  <a href="#" ng-click="share()" class="button btn-bg btn-fr">送给朋友</a>\r\n\t</div>--></div><div class="icon-hrer"><icon-href theme="white"></icon-href></div>'),e.put("app/gift/order/one2one/pay.html",'<div style="height:8px"></div><div class="empty-canvas empty-pay" ng-controller="GiftPayOne2OneCtrl"><div class="pay"><div class="card-pay"><div class="present-detail-summary"><p class="name">{{gift.info.name}}</p><p class="lead">{{gift.info.lead}}</p><div class="separate-box pay-bottom"><div class="separate-left">{{gift.info.price | currency}}</div><div class="separate-right trade-status-h"><span>1份</span></div><div class="clear"></div></div></div></div><div class="card-pay total-pay"><div class="card"><div class="separate-box"><div class="separate-left">总 计</div><div class="separate-right">{{ gift.info.price | currency }}</div><div class="clear"></div></div></div></div><!--/total-pay--><div class="pay-now"><a class="button btn-pay btn-green" ng-click="wxPay()" ng-disabled="submiting" ng-bind="submiting?\'支付中...\':\'支付\'"></a></div></div></div>'),e.put("app/gift/order/one2one/received.html",'<!--送礼人头像--><div class="head-center"><img ng-src="{{order.sender.info.headimgurl}}"></div><div class="head head-logo"><img class="icon-img" src="https://img.91pintuan.com/songli/i.png"><p class="center-mini-text">你所购买的礼物已送出！收礼人信息如下</p></div><div class="message-block content content1"><form class="form-horizontal" novalidate><input ng-disabled="true" class="input-msg form-text" type="text" name="consignee" ng-model="receiver.consignee"> <input ng-disabled="true" class="input-msg form-text" type="tel" name="telephone" ng-model="receiver.telephone"><textarea ng-disabled="true" rows="2" name="address" style="height:6em" class="input-msg form-textarea" ng-model="receiver.address"></textarea></form></div>'),e.put("app/gift/order/one2one/record.html",'<form name="giftAddrForm" novalidate><div class="sound-record sound-one" ng-style="{height:innerHeight-54+\'px\'}"><div class="to-who"><img src="https://img.91pintuan.com/songli/word_send_to.png"><br><input type="text" name="address.name" placeholder="{{giftAddrForm[\'address.name\'].$invalid && submitted?\'昵称未填写\':\'Ta的名字\'}}" ng-model="address.name" ng-maxlength="20" required class="input-msg input-one" ng-class="{\'error\':giftAddrForm[\'address.name\'].$invalid && submitted}"><p ng-show="giftAddrForm.name.$error.maxlength && submitted" class="help-block">昵称字数太多.</p></div><div class="voice-box"><div class="voice-process"><img src="https://img.91pintuan.com/songli/word_say_to.png"><timer interval="1000" countdown="60" autostart="false"><div class="progress"><div class="progress-active" id="pro" aria-valuenow="{{countdown}}" aria-valuemin="0" aria-valuemax="60" style="width: {{progressBar?progressBar:0}}%"></div></div><span class="label" id="second" style="text-align:right; display: block">{{countdown === 60?\'&nbsp;\':(60-countdown)+\'S\'}}</span></timer></div><!-- 开始录音 --><div id="record-before" ng-if="status.stop"><img src="https://img.91pintuan.com/songli/record.png" ng-click="record()"><br><span class="hint">点击开始录音</span></div><!-- 结束录音 --><div id="record-before" ng-if="status.start"><img src="https://img.91pintuan.com/songli/re_stop.png" ng-click="stop()"><br><span class="hint">结束录音</span></div><!-- 调试录音 --><div id="record-after" ng-if="status.record"><div class="left-button" ng-click="playVoice()"><img src="https://img.91pintuan.com/songli/play_red.png"><br><label class="hint">播放</label></div><div class="left-button" ng-click="rerecord()"><img src="https://img.91pintuan.com/songli/re_record.png"><br><label class="hint">重录</label></div><div class="right-button" ng-click="save()"><img src="https://img.91pintuan.com/songli/next_step.png"><br><label class="hint">下一步</label></div></div></div></div></form>')}]);